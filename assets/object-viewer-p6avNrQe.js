const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/spiderElement-CcVWrlae.js","assets/slendermanElement-CLgnoac4.js"])))=>i.map(i=>d[i]);
import{f as B,a as w,b as d,d as m,j as Ye,k as oe,P as Pe,a0 as Ze,a1 as qe,a2 as Fe,Z as Ne,K as re,W as ke,h as Ke,C as ae,M as Oe,V as Y,a3 as Xe,B as q,a4 as he,a5 as Je,a6 as $e,u as xe,a7 as Qe,D as et,a8 as ce,a9 as tt,N as nt,aa as st,ab as ot,ac as it,ad as rt,ae as at,af as ct,R as lt,ag as dt,ah as ut,S as le,Q as ht,$ as mt,X as pt,Y as ft,G as gt,ai as wt,aj as yt,ak as xt,al as Et,m as $,_ as bt,t as Mt}from"./slendermanElement-CLgnoac4.js";import{t as Tt,l as It,r as vt,s as At,m as St,n as Lt,v as _t,_ as W}from"./spiderElement-CcVWrlae.js";import{O as Rt}from"./OrbitControls-C7RAeUoe.js";function Ct(r=1,e=12436423,t=8359053){const s=new B,n=new w({color:e,roughness:.9}),o=new w({color:t,roughness:.7,metalness:.1});[{x:0,y:2,z:-3,w:6,h:4,d:.4},{x:0,y:2,z:3,w:6,h:4,d:.4},{x:-3,y:2,z:0,w:.4,h:4,d:6},{x:3,y:2,z:0,w:.4,h:4,d:6}].forEach(u=>{const g=new d(new m(u.w,u.h,u.d),n);g.position.set(u.x,u.y,u.z),g.castShadow=!0,g.receiveShadow=!0,s.add(g)});const a=new d(new Ye(5,2,4),o);a.position.y=5,a.rotation.y=Math.PI/4,a.castShadow=!0,s.add(a);const c=new w({color:5057307}),l=new d(new m(1,2.2,.1),c);l.position.set(0,1.1,3.26),s.add(l);const p=new w({color:8962303,metalness:.1,roughness:.2,transparent:!0,opacity:.8}),h=new d(new m(1,1,.05),p);h.position.set(-2,2.2,-3.26);const y=h.clone();return y.position.set(2,2.2,-3.26),s.add(h),s.add(y),s.scale.setScalar(r),s}const Bt=Object.freeze(Object.defineProperty({__proto__:null,createHouseElement:Ct},Symbol.toStringTag,{value:"Module"}));function Pt(){const r=new B;r.rotation.y=Math.random()*Math.PI*2;const e=new w({color:8359053}),t=new w({color:12436423}),s=8,n=8,o=6,i=.35,a=2.2,c=s/2,l=n/2,p=new d(new m(s,o,i),e);p.position.set(0,o/2,-l);const h=new d(new m(i,o,n),e);h.position.set(-c,o/2,0);const y=h.clone();y.position.x=c;const u=new d(new m((s-a)/2,o,i),e);u.position.set(-2.55,o/2,l);const g=u.clone();g.position.x=a/2+(s-a)/4,[p,h,y,u,g].forEach(A=>{A.castShadow=!0,A.receiveShadow=!0,r.add(A)});const f=new d(new m(s-.4,.3,n-.4),t);f.position.y=.15,f.receiveShadow=!0,r.add(f);const M=new d(new m(s-.4,.3,n-.4),t);M.position.y=3.4,M.receiveShadow=!0,r.add(M);const v=M.position.y,F=10,j=new m(3,v,F),x=new d(j,t);x.position.set(0,v/2,l+F/2),x.rotation.x=-Math.atan(v/F),x.castShadow=!0,x.receiveShadow=!0,r.add(x);const b=new d(new m(s+.4,.4,n+.4),new w({color:9807270}));return b.position.y=o+.2,b.castShadow=!0,r.add(b),r}const Ft=Object.freeze(Object.defineProperty({__proto__:null,createSmallBuildingElement:Pt},Symbol.toStringTag,{value:"Module"}));function Nt(r=10,e=8){const t=new B,s=new w({color:8355711,roughness:1}),n=new d(new oe(r,r*1.05,e,16,1),s);n.position.set(0,e/2,0),n.castShadow=!0,n.receiveShadow=!0,t.add(n);const o=r*1.4,i=e,a=r*.8,c=new m(a,i,o),l=new d(c,new w({color:9342606,roughness:1}));l.castShadow=!0,l.receiveShadow=!0;const p=Math.atan(i/o);l.rotation.x=-p,l.position.set(0,i/2,r),l.userData={type:"house"},t.add(l);const h=new m(a,.2,o),y=new d(h,new w({color:7105644}));return y.position.set(0,i,r),y.rotation.x=l.rotation.x,y.castShadow=!0,t.add(y),t}const kt=Object.freeze(Object.defineProperty({__proto__:null,createPlateauElement:Nt},Symbol.toStringTag,{value:"Module"}));let Q,me,J,ie;function pe(r,e=1/0,t=null){me||(me=new Pe(2,2,1,1)),J||(J=new Ze({uniforms:{blitTexture:new qe(r)},vertexShader:`
			varying vec2 vUv;
			void main(){
				vUv = uv;
				gl_Position = vec4(position.xy * 1.0,0.,.999999);
			}`,fragmentShader:`
			uniform sampler2D blitTexture; 
			varying vec2 vUv;

			void main(){ 
				gl_FragColor = vec4(vUv.xy, 0, 1);
				
				#ifdef IS_SRGB
				gl_FragColor = LinearTosRGB( texture2D( blitTexture, vUv) );
				#else
				gl_FragColor = texture2D( blitTexture, vUv);
				#endif
			}`})),J.uniforms.blitTexture.value=r,J.defines.IS_SRGB=r.colorSpace==Fe,J.needsUpdate=!0,ie||(ie=new d(me,J),ie.frustrumCulled=!1);const s=new Ne,n=new re;n.add(ie),t===null&&(t=Q=new ke({antialias:!1}));const o=Math.min(r.image.width,e),i=Math.min(r.image.height,e);t.setSize(o,i),t.clear(),t.render(n,s);const a=document.createElement("canvas"),c=a.getContext("2d");a.width=o,a.height=i,c.drawImage(t.domElement,0,0,o,i);const l=new Ke(a);return l.minFilter=r.minFilter,l.magFilter=r.magFilter,l.wrapS=r.wrapS,l.wrapT=r.wrapT,l.name=r.name,Q&&(Q.forceContextLoss(),Q.dispose(),Q=null),l}const Se={POSITION:["byte","byte normalized","unsigned byte","unsigned byte normalized","short","short normalized","unsigned short","unsigned short normalized"],NORMAL:["byte normalized","short normalized"],TANGENT:["byte normalized","short normalized"],TEXCOORD:["byte","byte normalized","unsigned byte","short","short normalized","unsigned short"]};class Me{constructor(){this.pluginCallbacks=[],this.register(function(e){return new Yt(e)}),this.register(function(e){return new Zt(e)}),this.register(function(e){return new Xt(e)}),this.register(function(e){return new Jt(e)}),this.register(function(e){return new $t(e)}),this.register(function(e){return new Qt(e)}),this.register(function(e){return new qt(e)}),this.register(function(e){return new Kt(e)}),this.register(function(e){return new en(e)}),this.register(function(e){return new tn(e)}),this.register(function(e){return new nn(e)}),this.register(function(e){return new sn(e)}),this.register(function(e){return new on(e)})}register(e){return this.pluginCallbacks.indexOf(e)===-1&&this.pluginCallbacks.push(e),this}unregister(e){return this.pluginCallbacks.indexOf(e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,s,n){const o=new Wt,i=[];for(let a=0,c=this.pluginCallbacks.length;a<c;a++)i.push(this.pluginCallbacks[a](o));o.setPlugins(i),o.write(e,t,n).catch(s)}parseAsync(e,t){const s=this;return new Promise(function(n,o){s.parse(e,n,o,t)})}}const T={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,REPEAT:10497},fe="KHR_mesh_quantization",G={};G[nt]=T.NEAREST;G[st]=T.NEAREST_MIPMAP_NEAREST;G[ot]=T.NEAREST_MIPMAP_LINEAR;G[it]=T.LINEAR;G[rt]=T.LINEAR_MIPMAP_NEAREST;G[at]=T.LINEAR_MIPMAP_LINEAR;G[ct]=T.CLAMP_TO_EDGE;G[lt]=T.REPEAT;G[dt]=T.MIRRORED_REPEAT;const Le={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"},Ot=new ae,_e=12,Ut=1179937895,jt=2,Re=8,zt=1313821514,Gt=5130562;function te(r,e){return r.length===e.length&&r.every(function(t,s){return t===e[s]})}function Ht(r){return new TextEncoder().encode(r).buffer}function Dt(r){return te(r.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}function Vt(r,e,t){const s={min:new Array(r.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(r.itemSize).fill(Number.NEGATIVE_INFINITY)};for(let n=e;n<e+t;n++)for(let o=0;o<r.itemSize;o++){let i;r.itemSize>4?i=r.array[n*r.itemSize+o]:(o===0?i=r.getX(n):o===1?i=r.getY(n):o===2?i=r.getZ(n):o===3&&(i=r.getW(n)),r.normalized===!0&&(i=xe.normalize(i,r.array))),s.min[o]=Math.min(s.min[o],i),s.max[o]=Math.max(s.max[o],i)}return s}function Ue(r){return Math.ceil(r/4)*4}function ge(r,e=0){const t=Ue(r.byteLength);if(t!==r.byteLength){const s=new Uint8Array(t);if(s.set(new Uint8Array(r)),e!==0)for(let n=r.byteLength;n<t;n++)s[n]=e;return s.buffer}return r}function Ce(){return typeof document>"u"&&typeof OffscreenCanvas<"u"?new OffscreenCanvas(1,1):document.createElement("canvas")}function Be(r,e){if(r.toBlob!==void 0)return new Promise(s=>r.toBlob(s,e));let t;return e==="image/jpeg"?t=.92:e==="image/webp"&&(t=.8),r.convertToBlob({type:e,quality:t})}class Wt{constructor(){this.plugins=[],this.options={},this.pending=[],this.buffers=[],this.byteOffset=0,this.buffers=[],this.nodeMap=new Map,this.skins=[],this.extensionsUsed={},this.extensionsRequired={},this.uids=new Map,this.uid=0,this.json={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},this.cache={meshes:new Map,attributes:new Map,attributesNormalized:new Map,materials:new Map,textures:new Map,images:new Map}}setPlugins(e){this.plugins=e}async write(e,t,s={}){this.options=Object.assign({binary:!1,trs:!1,onlyVisible:!0,maxTextureSize:1/0,animations:[],includeCustomExtensions:!1},s),this.options.animations.length>0&&(this.options.trs=!0),this.processInput(e),await Promise.all(this.pending);const n=this,o=n.buffers,i=n.json;s=n.options;const a=n.extensionsUsed,c=n.extensionsRequired,l=new Blob(o,{type:"application/octet-stream"}),p=Object.keys(a),h=Object.keys(c);if(p.length>0&&(i.extensionsUsed=p),h.length>0&&(i.extensionsRequired=h),i.buffers&&i.buffers.length>0&&(i.buffers[0].byteLength=l.size),s.binary===!0){const y=new FileReader;y.readAsArrayBuffer(l),y.onloadend=function(){const u=ge(y.result),g=new DataView(new ArrayBuffer(Re));g.setUint32(0,u.byteLength,!0),g.setUint32(4,Gt,!0);const f=ge(Ht(JSON.stringify(i)),32),M=new DataView(new ArrayBuffer(Re));M.setUint32(0,f.byteLength,!0),M.setUint32(4,zt,!0);const v=new ArrayBuffer(_e),F=new DataView(v);F.setUint32(0,Ut,!0),F.setUint32(4,jt,!0);const j=_e+M.byteLength+f.byteLength+g.byteLength+u.byteLength;F.setUint32(8,j,!0);const x=new Blob([v,M,f,g,u],{type:"application/octet-stream"}),b=new FileReader;b.readAsArrayBuffer(x),b.onloadend=function(){t(b.result)}}}else if(i.buffers&&i.buffers.length>0){const y=new FileReader;y.readAsDataURL(l),y.onloadend=function(){const u=y.result;i.buffers[0].uri=u,t(i)}}else t(i)}serializeUserData(e,t){if(Object.keys(e.userData).length===0)return;const s=this.options,n=this.extensionsUsed;try{const o=JSON.parse(JSON.stringify(e.userData));if(s.includeCustomExtensions&&o.gltfExtensions){t.extensions===void 0&&(t.extensions={});for(const i in o.gltfExtensions)t.extensions[i]=o.gltfExtensions[i],n[i]=!0;delete o.gltfExtensions}Object.keys(o).length>0&&(t.extras=o)}catch(o){console.warn("THREE.GLTFExporter: userData of '"+e.name+"' won't be serialized because of JSON.stringify error - "+o.message)}}getUID(e,t=!1){if(this.uids.has(e)===!1){const n=new Map;n.set(!0,this.uid++),n.set(!1,this.uid++),this.uids.set(e,n)}return this.uids.get(e).get(t)}isNormalizedNormalAttribute(e){if(this.cache.attributesNormalized.has(e))return!1;const s=new Y;for(let n=0,o=e.count;n<o;n++)if(Math.abs(s.fromBufferAttribute(e,n).length()-1)>5e-4)return!1;return!0}createNormalizedNormalAttribute(e){const t=this.cache;if(t.attributesNormalized.has(e))return t.attributesNormalized.get(e);const s=e.clone(),n=new Y;for(let o=0,i=s.count;o<i;o++)n.fromBufferAttribute(s,o),n.x===0&&n.y===0&&n.z===0?n.setX(1):n.normalize(),s.setXYZ(o,n.x,n.y,n.z);return t.attributesNormalized.set(e,s),s}applyTextureTransform(e,t){let s=!1;const n={};(t.offset.x!==0||t.offset.y!==0)&&(n.offset=t.offset.toArray(),s=!0),t.rotation!==0&&(n.rotation=t.rotation,s=!0),(t.repeat.x!==1||t.repeat.y!==1)&&(n.scale=t.repeat.toArray(),s=!0),s&&(e.extensions=e.extensions||{},e.extensions.KHR_texture_transform=n,this.extensionsUsed.KHR_texture_transform=!0)}buildMetalRoughTexture(e,t){if(e===t)return e;function s(u){return u.colorSpace===Fe?function(f){return f<.04045?f*.0773993808:Math.pow(f*.9478672986+.0521327014,2.4)}:function(f){return f}}console.warn("THREE.GLTFExporter: Merged metalnessMap and roughnessMap textures."),e instanceof he&&(e=pe(e)),t instanceof he&&(t=pe(t));const n=e?e.image:null,o=t?t.image:null,i=Math.max(n?n.width:0,o?o.width:0),a=Math.max(n?n.height:0,o?o.height:0),c=Ce();c.width=i,c.height=a;const l=c.getContext("2d");l.fillStyle="#00ffff",l.fillRect(0,0,i,a);const p=l.getImageData(0,0,i,a);if(n){l.drawImage(n,0,0,i,a);const u=s(e),g=l.getImageData(0,0,i,a).data;for(let f=2;f<g.length;f+=4)p.data[f]=u(g[f]/256)*256}if(o){l.drawImage(o,0,0,i,a);const u=s(t),g=l.getImageData(0,0,i,a).data;for(let f=1;f<g.length;f+=4)p.data[f]=u(g[f]/256)*256}l.putImageData(p,0,0);const y=(e||t).clone();return y.source=new Je(c),y.colorSpace=$e,y.channel=(e||t).channel,e&&t&&e.channel!==t.channel&&console.warn("THREE.GLTFExporter: UV channels for metalnessMap and roughnessMap textures must match."),y}processBuffer(e){const t=this.json,s=this.buffers;return t.buffers||(t.buffers=[{byteLength:0}]),s.push(e),0}processBufferView(e,t,s,n,o){const i=this.json;i.bufferViews||(i.bufferViews=[]);let a;switch(t){case T.BYTE:case T.UNSIGNED_BYTE:a=1;break;case T.SHORT:case T.UNSIGNED_SHORT:a=2;break;default:a=4}const c=Ue(n*e.itemSize*a),l=new DataView(new ArrayBuffer(c));let p=0;for(let u=s;u<s+n;u++)for(let g=0;g<e.itemSize;g++){let f;e.itemSize>4?f=e.array[u*e.itemSize+g]:(g===0?f=e.getX(u):g===1?f=e.getY(u):g===2?f=e.getZ(u):g===3&&(f=e.getW(u)),e.normalized===!0&&(f=xe.normalize(f,e.array))),t===T.FLOAT?l.setFloat32(p,f,!0):t===T.INT?l.setInt32(p,f,!0):t===T.UNSIGNED_INT?l.setUint32(p,f,!0):t===T.SHORT?l.setInt16(p,f,!0):t===T.UNSIGNED_SHORT?l.setUint16(p,f,!0):t===T.BYTE?l.setInt8(p,f):t===T.UNSIGNED_BYTE&&l.setUint8(p,f),p+=a}const h={buffer:this.processBuffer(l.buffer),byteOffset:this.byteOffset,byteLength:c};return o!==void 0&&(h.target=o),o===T.ARRAY_BUFFER&&(h.byteStride=e.itemSize*a),this.byteOffset+=c,i.bufferViews.push(h),{id:i.bufferViews.length-1,byteLength:0}}processBufferViewImage(e){const t=this,s=t.json;return s.bufferViews||(s.bufferViews=[]),new Promise(function(n){const o=new FileReader;o.readAsArrayBuffer(e),o.onloadend=function(){const i=ge(o.result),a={buffer:t.processBuffer(i),byteOffset:t.byteOffset,byteLength:i.byteLength};t.byteOffset+=i.byteLength,n(s.bufferViews.push(a)-1)}})}processAccessor(e,t,s,n){const o=this.json,i={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",9:"MAT3",16:"MAT4"};let a;if(e.array.constructor===Float32Array)a=T.FLOAT;else if(e.array.constructor===Int32Array)a=T.INT;else if(e.array.constructor===Uint32Array)a=T.UNSIGNED_INT;else if(e.array.constructor===Int16Array)a=T.SHORT;else if(e.array.constructor===Uint16Array)a=T.UNSIGNED_SHORT;else if(e.array.constructor===Int8Array)a=T.BYTE;else if(e.array.constructor===Uint8Array)a=T.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type: "+e.array.constructor.name);if(s===void 0&&(s=0),(n===void 0||n===1/0)&&(n=e.count),n===0)return null;const c=Vt(e,s,n);let l;t!==void 0&&(l=e===t.index?T.ELEMENT_ARRAY_BUFFER:T.ARRAY_BUFFER);const p=this.processBufferView(e,a,s,n,l),h={bufferView:p.id,byteOffset:p.byteOffset,componentType:a,count:n,max:c.max,min:c.min,type:i[e.itemSize]};return e.normalized===!0&&(h.normalized=!0),o.accessors||(o.accessors=[]),o.accessors.push(h)-1}processImage(e,t,s,n="image/png"){if(e!==null){const o=this,i=o.cache,a=o.json,c=o.options,l=o.pending;i.images.has(e)||i.images.set(e,{});const p=i.images.get(e),h=n+":flipY/"+s.toString();if(p[h]!==void 0)return p[h];a.images||(a.images=[]);const y={mimeType:n},u=Ce();u.width=Math.min(e.width,c.maxTextureSize),u.height=Math.min(e.height,c.maxTextureSize);const g=u.getContext("2d");if(s===!0&&(g.translate(0,u.height),g.scale(1,-1)),e.data!==void 0){t!==Qe&&console.error("GLTFExporter: Only RGBAFormat is supported.",t),(e.width>c.maxTextureSize||e.height>c.maxTextureSize)&&console.warn("GLTFExporter: Image size is bigger than maxTextureSize",e);const M=new Uint8ClampedArray(e.height*e.width*4);for(let v=0;v<M.length;v+=4)M[v+0]=e.data[v+0],M[v+1]=e.data[v+1],M[v+2]=e.data[v+2],M[v+3]=e.data[v+3];g.putImageData(new ImageData(M,e.width,e.height),0,0)}else g.drawImage(e,0,0,u.width,u.height);c.binary===!0?l.push(Be(u,n).then(M=>o.processBufferViewImage(M)).then(M=>{y.bufferView=M})):u.toDataURL!==void 0?y.uri=u.toDataURL(n):l.push(Be(u,n).then(M=>new FileReader().readAsDataURL(M)).then(M=>{y.uri=M}));const f=a.images.push(y)-1;return p[h]=f,f}else throw new Error("THREE.GLTFExporter: No valid image data found. Unable to process texture.")}processSampler(e){const t=this.json;t.samplers||(t.samplers=[]);const s={magFilter:G[e.magFilter],minFilter:G[e.minFilter],wrapS:G[e.wrapS],wrapT:G[e.wrapT]};return t.samplers.push(s)-1}processTexture(e){const s=this.options,n=this.cache,o=this.json;if(n.textures.has(e))return n.textures.get(e);o.textures||(o.textures=[]),e instanceof he&&(e=pe(e,s.maxTextureSize));let i=e.userData.mimeType;i==="image/webp"&&(i="image/png");const a={sampler:this.processSampler(e),source:this.processImage(e.image,e.format,e.flipY,i)};e.name&&(a.name=e.name),this._invokeAll(function(l){l.writeTexture&&l.writeTexture(e,a)});const c=o.textures.push(a)-1;return n.textures.set(e,c),c}processMaterial(e){const t=this.cache,s=this.json;if(t.materials.has(e))return t.materials.get(e);if(e.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;s.materials||(s.materials=[]);const n={pbrMetallicRoughness:{}};e.isMeshStandardMaterial!==!0&&e.isMeshBasicMaterial!==!0&&console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");const o=e.color.toArray().concat([e.opacity]);if(te(o,[1,1,1,1])||(n.pbrMetallicRoughness.baseColorFactor=o),e.isMeshStandardMaterial?(n.pbrMetallicRoughness.metallicFactor=e.metalness,n.pbrMetallicRoughness.roughnessFactor=e.roughness):(n.pbrMetallicRoughness.metallicFactor=.5,n.pbrMetallicRoughness.roughnessFactor=.5),e.metalnessMap||e.roughnessMap){const a=this.buildMetalRoughTexture(e.metalnessMap,e.roughnessMap),c={index:this.processTexture(a),channel:a.channel};this.applyTextureTransform(c,a),n.pbrMetallicRoughness.metallicRoughnessTexture=c}if(e.map){const a={index:this.processTexture(e.map),texCoord:e.map.channel};this.applyTextureTransform(a,e.map),n.pbrMetallicRoughness.baseColorTexture=a}if(e.emissive){const a=e.emissive;if(Math.max(a.r,a.g,a.b)>0&&(n.emissiveFactor=e.emissive.toArray()),e.emissiveMap){const l={index:this.processTexture(e.emissiveMap),texCoord:e.emissiveMap.channel};this.applyTextureTransform(l,e.emissiveMap),n.emissiveTexture=l}}if(e.normalMap){const a={index:this.processTexture(e.normalMap),texCoord:e.normalMap.channel};e.normalScale&&e.normalScale.x!==1&&(a.scale=e.normalScale.x),this.applyTextureTransform(a,e.normalMap),n.normalTexture=a}if(e.aoMap){const a={index:this.processTexture(e.aoMap),texCoord:e.aoMap.channel};e.aoMapIntensity!==1&&(a.strength=e.aoMapIntensity),this.applyTextureTransform(a,e.aoMap),n.occlusionTexture=a}e.transparent?n.alphaMode="BLEND":e.alphaTest>0&&(n.alphaMode="MASK",n.alphaCutoff=e.alphaTest),e.side===et&&(n.doubleSided=!0),e.name!==""&&(n.name=e.name),this.serializeUserData(e,n),this._invokeAll(function(a){a.writeMaterial&&a.writeMaterial(e,n)});const i=s.materials.push(n)-1;return t.materials.set(e,i),i}processMesh(e){const t=this.cache,s=this.json,n=[e.geometry.uuid];if(Array.isArray(e.material))for(let x=0,b=e.material.length;x<b;x++)n.push(e.material[x].uuid);else n.push(e.material.uuid);const o=n.join(":");if(t.meshes.has(o))return t.meshes.get(o);const i=e.geometry;let a;e.isLineSegments?a=T.LINES:e.isLineLoop?a=T.LINE_LOOP:e.isLine?a=T.LINE_STRIP:e.isPoints?a=T.POINTS:a=e.material.wireframe?T.LINES:T.TRIANGLES;const c={},l={},p=[],h=[],y={uv:"TEXCOORD_0",uv1:"TEXCOORD_1",uv2:"TEXCOORD_2",uv3:"TEXCOORD_3",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},u=i.getAttribute("normal");u!==void 0&&!this.isNormalizedNormalAttribute(u)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),i.setAttribute("normal",this.createNormalizedNormalAttribute(u)));let g=null;for(let x in i.attributes){if(x.slice(0,5)==="morph")continue;const b=i.attributes[x];if(x=y[x]||x.toUpperCase(),/^(POSITION|NORMAL|TANGENT|TEXCOORD_\d+|COLOR_\d+|JOINTS_\d+|WEIGHTS_\d+)$/.test(x)||(x="_"+x),t.attributes.has(this.getUID(b))){l[x]=t.attributes.get(this.getUID(b));continue}g=null;const _=b.array;x==="JOINTS_0"&&!(_ instanceof Uint16Array)&&!(_ instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),g=new q(new Uint16Array(_),b.itemSize,b.normalized));const N=this.processAccessor(g||b,i);N!==null&&(x.startsWith("_")||this.detectMeshQuantization(x,b),l[x]=N,t.attributes.set(this.getUID(b),N))}if(u!==void 0&&i.setAttribute("normal",u),Object.keys(l).length===0)return null;if(e.morphTargetInfluences!==void 0&&e.morphTargetInfluences.length>0){const x=[],b=[],A={};if(e.morphTargetDictionary!==void 0)for(const _ in e.morphTargetDictionary)A[e.morphTargetDictionary[_]]=_;for(let _=0;_<e.morphTargetInfluences.length;++_){const N={};let Z=!1;for(const R in i.morphAttributes){if(R!=="position"&&R!=="normal"){Z||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Z=!0);continue}const O=i.morphAttributes[R][_],z=R.toUpperCase(),H=i.attributes[R];if(t.attributes.has(this.getUID(O,!0))){N[z]=t.attributes.get(this.getUID(O,!0));continue}const P=O.clone();if(!i.morphTargetsRelative)for(let C=0,D=O.count;C<D;C++)for(let V=0;V<O.itemSize;V++)V===0&&P.setX(C,O.getX(C)-H.getX(C)),V===1&&P.setY(C,O.getY(C)-H.getY(C)),V===2&&P.setZ(C,O.getZ(C)-H.getZ(C)),V===3&&P.setW(C,O.getW(C)-H.getW(C));N[z]=this.processAccessor(P,i),t.attributes.set(this.getUID(H,!0),N[z])}h.push(N),x.push(e.morphTargetInfluences[_]),e.morphTargetDictionary!==void 0&&b.push(A[_])}c.weights=x,b.length>0&&(c.extras={},c.extras.targetNames=b)}const f=Array.isArray(e.material);if(f&&i.groups.length===0)return null;let M=!1;if(f&&i.index===null){const x=[];for(let b=0,A=i.attributes.position.count;b<A;b++)x[b]=b;i.setIndex(x),M=!0}const v=f?e.material:[e.material],F=f?i.groups:[{materialIndex:0,start:void 0,count:void 0}];for(let x=0,b=F.length;x<b;x++){const A={mode:a,attributes:l};if(this.serializeUserData(i,A),h.length>0&&(A.targets=h),i.index!==null){let N=this.getUID(i.index);(F[x].start!==void 0||F[x].count!==void 0)&&(N+=":"+F[x].start+":"+F[x].count),t.attributes.has(N)?A.indices=t.attributes.get(N):(A.indices=this.processAccessor(i.index,i,F[x].start,F[x].count),t.attributes.set(N,A.indices)),A.indices===null&&delete A.indices}const _=this.processMaterial(v[F[x].materialIndex]);_!==null&&(A.material=_),p.push(A)}M===!0&&i.setIndex(null),c.primitives=p,s.meshes||(s.meshes=[]),this._invokeAll(function(x){x.writeMesh&&x.writeMesh(e,c)});const j=s.meshes.push(c)-1;return t.meshes.set(o,j),j}detectMeshQuantization(e,t){if(this.extensionsUsed[fe])return;let s;switch(t.array.constructor){case Int8Array:s="byte";break;case Uint8Array:s="unsigned byte";break;case Int16Array:s="short";break;case Uint16Array:s="unsigned short";break;default:return}t.normalized&&(s+=" normalized");const n=e.split("_",1)[0];Se[n]&&Se[n].includes(s)&&(this.extensionsUsed[fe]=!0,this.extensionsRequired[fe]=!0)}processCamera(e){const t=this.json;t.cameras||(t.cameras=[]);const s=e.isOrthographicCamera,n={type:s?"orthographic":"perspective"};return s?n.orthographic={xmag:e.right*2,ymag:e.top*2,zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near}:n.perspective={aspectRatio:e.aspect,yfov:xe.degToRad(e.fov),zfar:e.far<=0?.001:e.far,znear:e.near<0?0:e.near},e.name!==""&&(n.name=e.type),t.cameras.push(n)-1}processAnimation(e,t){const s=this.json,n=this.nodeMap;s.animations||(s.animations=[]),e=Me.Utils.mergeMorphTargetTracks(e.clone(),t);const o=e.tracks,i=[],a=[];for(let c=0;c<o.length;++c){const l=o[c],p=ce.parseTrackName(l.name);let h=ce.findNode(t,p.nodeName);const y=Le[p.propertyName];if(p.objectName==="bones"&&(h.isSkinnedMesh===!0?h=h.skeleton.getBoneByName(p.objectIndex):h=void 0),!h||!y)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',l.name),null;const u=1;let g=l.values.length/l.times.length;y===Le.morphTargetInfluences&&(g/=h.morphTargetInfluences.length);let f;l.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(f="CUBICSPLINE",g/=3):l.getInterpolation()===tt?f="STEP":f="LINEAR",a.push({input:this.processAccessor(new q(l.times,u)),output:this.processAccessor(new q(l.values,g)),interpolation:f}),i.push({sampler:a.length-1,target:{node:n.get(h),path:y}})}return s.animations.push({name:e.name||"clip_"+s.animations.length,samplers:a,channels:i}),s.animations.length-1}processSkin(e){const t=this.json,s=this.nodeMap,n=t.nodes[s.get(e)],o=e.skeleton;if(o===void 0)return null;const i=e.skeleton.bones[0];if(i===void 0)return null;const a=[],c=new Float32Array(o.bones.length*16),l=new Oe;for(let h=0;h<o.bones.length;++h)a.push(s.get(o.bones[h])),l.copy(o.boneInverses[h]),l.multiply(e.bindMatrix).toArray(c,h*16);return t.skins===void 0&&(t.skins=[]),t.skins.push({inverseBindMatrices:this.processAccessor(new q(c,16)),joints:a,skeleton:s.get(i)}),n.skin=t.skins.length-1}processNode(e){const t=this.json,s=this.options,n=this.nodeMap;t.nodes||(t.nodes=[]);const o={};if(s.trs){const a=e.quaternion.toArray(),c=e.position.toArray(),l=e.scale.toArray();te(a,[0,0,0,1])||(o.rotation=a),te(c,[0,0,0])||(o.translation=c),te(l,[1,1,1])||(o.scale=l)}else e.matrixAutoUpdate&&e.updateMatrix(),Dt(e.matrix)===!1&&(o.matrix=e.matrix.elements);if(e.name!==""&&(o.name=String(e.name)),this.serializeUserData(e,o),e.isMesh||e.isLine||e.isPoints){const a=this.processMesh(e);a!==null&&(o.mesh=a)}else e.isCamera&&(o.camera=this.processCamera(e));if(e.isSkinnedMesh&&this.skins.push(e),e.children.length>0){const a=[];for(let c=0,l=e.children.length;c<l;c++){const p=e.children[c];if(p.visible||s.onlyVisible===!1){const h=this.processNode(p);h!==null&&a.push(h)}}a.length>0&&(o.children=a)}this._invokeAll(function(a){a.writeNode&&a.writeNode(e,o)});const i=t.nodes.push(o)-1;return n.set(e,i),i}processScene(e){const t=this.json,s=this.options;t.scenes||(t.scenes=[],t.scene=0);const n={};e.name!==""&&(n.name=e.name),t.scenes.push(n);const o=[];for(let i=0,a=e.children.length;i<a;i++){const c=e.children[i];if(c.visible||s.onlyVisible===!1){const l=this.processNode(c);l!==null&&o.push(l)}}o.length>0&&(n.nodes=o),this.serializeUserData(e,n)}processObjects(e){const t=new re;t.name="AuxScene";for(let s=0;s<e.length;s++)t.children.push(e[s]);this.processScene(t)}processInput(e){const t=this.options;e=e instanceof Array?e:[e],this._invokeAll(function(n){n.beforeParse&&n.beforeParse(e)});const s=[];for(let n=0;n<e.length;n++)e[n]instanceof re?this.processScene(e[n]):s.push(e[n]);s.length>0&&this.processObjects(s);for(let n=0;n<this.skins.length;++n)this.processSkin(this.skins[n]);for(let n=0;n<t.animations.length;++n)this.processAnimation(t.animations[n],e[0]);this._invokeAll(function(n){n.afterParse&&n.afterParse(e)})}_invokeAll(e){for(let t=0,s=this.plugins.length;t<s;t++)e(this.plugins[t])}}class Yt{constructor(e){this.writer=e,this.name="KHR_lights_punctual"}writeNode(e,t){if(!e.isLight)return;if(!e.isDirectionalLight&&!e.isPointLight&&!e.isSpotLight){console.warn("THREE.GLTFExporter: Only directional, point, and spot lights are supported.",e);return}const s=this.writer,n=s.json,o=s.extensionsUsed,i={};e.name&&(i.name=e.name),i.color=e.color.toArray(),i.intensity=e.intensity,e.isDirectionalLight?i.type="directional":e.isPointLight?(i.type="point",e.distance>0&&(i.range=e.distance)):e.isSpotLight&&(i.type="spot",e.distance>0&&(i.range=e.distance),i.spot={},i.spot.innerConeAngle=(1-e.penumbra)*e.angle,i.spot.outerConeAngle=e.angle),e.decay!==void 0&&e.decay!==2&&console.warn("THREE.GLTFExporter: Light decay may be lost. glTF is physically-based, and expects light.decay=2."),e.target&&(e.target.parent!==e||e.target.position.x!==0||e.target.position.y!==0||e.target.position.z!==-1)&&console.warn("THREE.GLTFExporter: Light direction may be lost. For best results, make light.target a child of the light with position 0,0,-1."),o[this.name]||(n.extensions=n.extensions||{},n.extensions[this.name]={lights:[]},o[this.name]=!0);const a=n.extensions[this.name].lights;a.push(i),t.extensions=t.extensions||{},t.extensions[this.name]={light:a.length-1}}}class Zt{constructor(e){this.writer=e,this.name="KHR_materials_unlit"}writeMaterial(e,t){if(!e.isMeshBasicMaterial)return;const n=this.writer.extensionsUsed;t.extensions=t.extensions||{},t.extensions[this.name]={},n[this.name]=!0,t.pbrMetallicRoughness.metallicFactor=0,t.pbrMetallicRoughness.roughnessFactor=.9}}class qt{constructor(e){this.writer=e,this.name="KHR_materials_clearcoat"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.clearcoat===0)return;const s=this.writer,n=s.extensionsUsed,o={};if(o.clearcoatFactor=e.clearcoat,e.clearcoatMap){const i={index:s.processTexture(e.clearcoatMap),texCoord:e.clearcoatMap.channel};s.applyTextureTransform(i,e.clearcoatMap),o.clearcoatTexture=i}if(o.clearcoatRoughnessFactor=e.clearcoatRoughness,e.clearcoatRoughnessMap){const i={index:s.processTexture(e.clearcoatRoughnessMap),texCoord:e.clearcoatRoughnessMap.channel};s.applyTextureTransform(i,e.clearcoatRoughnessMap),o.clearcoatRoughnessTexture=i}if(e.clearcoatNormalMap){const i={index:s.processTexture(e.clearcoatNormalMap),texCoord:e.clearcoatNormalMap.channel};s.applyTextureTransform(i,e.clearcoatNormalMap),o.clearcoatNormalTexture=i}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Kt{constructor(e){this.writer=e,this.name="KHR_materials_iridescence"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.iridescence===0)return;const s=this.writer,n=s.extensionsUsed,o={};if(o.iridescenceFactor=e.iridescence,e.iridescenceMap){const i={index:s.processTexture(e.iridescenceMap),texCoord:e.iridescenceMap.channel};s.applyTextureTransform(i,e.iridescenceMap),o.iridescenceTexture=i}if(o.iridescenceIor=e.iridescenceIOR,o.iridescenceThicknessMinimum=e.iridescenceThicknessRange[0],o.iridescenceThicknessMaximum=e.iridescenceThicknessRange[1],e.iridescenceThicknessMap){const i={index:s.processTexture(e.iridescenceThicknessMap),texCoord:e.iridescenceThicknessMap.channel};s.applyTextureTransform(i,e.iridescenceThicknessMap),o.iridescenceThicknessTexture=i}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Xt{constructor(e){this.writer=e,this.name="KHR_materials_transmission"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const s=this.writer,n=s.extensionsUsed,o={};if(o.transmissionFactor=e.transmission,e.transmissionMap){const i={index:s.processTexture(e.transmissionMap),texCoord:e.transmissionMap.channel};s.applyTextureTransform(i,e.transmissionMap),o.transmissionTexture=i}t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Jt{constructor(e){this.writer=e,this.name="KHR_materials_volume"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.transmission===0)return;const s=this.writer,n=s.extensionsUsed,o={};if(o.thicknessFactor=e.thickness,e.thicknessMap){const i={index:s.processTexture(e.thicknessMap),texCoord:e.thicknessMap.channel};s.applyTextureTransform(i,e.thicknessMap),o.thicknessTexture=i}o.attenuationDistance=e.attenuationDistance,o.attenuationColor=e.attenuationColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class $t{constructor(e){this.writer=e,this.name="KHR_materials_ior"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.ior===1.5)return;const n=this.writer.extensionsUsed,o={};o.ior=e.ior,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class Qt{constructor(e){this.writer=e,this.name="KHR_materials_specular"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.specularIntensity===1&&e.specularColor.equals(Ot)&&!e.specularIntensityMap&&!e.specularColorMap)return;const s=this.writer,n=s.extensionsUsed,o={};if(e.specularIntensityMap){const i={index:s.processTexture(e.specularIntensityMap),texCoord:e.specularIntensityMap.channel};s.applyTextureTransform(i,e.specularIntensityMap),o.specularTexture=i}if(e.specularColorMap){const i={index:s.processTexture(e.specularColorMap),texCoord:e.specularColorMap.channel};s.applyTextureTransform(i,e.specularColorMap),o.specularColorTexture=i}o.specularFactor=e.specularIntensity,o.specularColorFactor=e.specularColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class en{constructor(e){this.writer=e,this.name="KHR_materials_sheen"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.sheen==0)return;const s=this.writer,n=s.extensionsUsed,o={};if(e.sheenRoughnessMap){const i={index:s.processTexture(e.sheenRoughnessMap),texCoord:e.sheenRoughnessMap.channel};s.applyTextureTransform(i,e.sheenRoughnessMap),o.sheenRoughnessTexture=i}if(e.sheenColorMap){const i={index:s.processTexture(e.sheenColorMap),texCoord:e.sheenColorMap.channel};s.applyTextureTransform(i,e.sheenColorMap),o.sheenColorTexture=i}o.sheenRoughnessFactor=e.sheenRoughness,o.sheenColorFactor=e.sheenColor.toArray(),t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class tn{constructor(e){this.writer=e,this.name="KHR_materials_anisotropy"}writeMaterial(e,t){if(!e.isMeshPhysicalMaterial||e.anisotropy==0)return;const s=this.writer,n=s.extensionsUsed,o={};if(e.anisotropyMap){const i={index:s.processTexture(e.anisotropyMap)};s.applyTextureTransform(i,e.anisotropyMap),o.anisotropyTexture=i}o.anisotropyStrength=e.anisotropy,o.anisotropyRotation=e.anisotropyRotation,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class nn{constructor(e){this.writer=e,this.name="KHR_materials_emissive_strength"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||e.emissiveIntensity===1)return;const n=this.writer.extensionsUsed,o={};o.emissiveStrength=e.emissiveIntensity,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class sn{constructor(e){this.writer=e,this.name="EXT_materials_bump"}writeMaterial(e,t){if(!e.isMeshStandardMaterial||e.bumpScale===1&&!e.bumpMap)return;const s=this.writer,n=s.extensionsUsed,o={};if(e.bumpMap){const i={index:s.processTexture(e.bumpMap),texCoord:e.bumpMap.channel};s.applyTextureTransform(i,e.bumpMap),o.bumpTexture=i}o.bumpFactor=e.bumpScale,t.extensions=t.extensions||{},t.extensions[this.name]=o,n[this.name]=!0}}class on{constructor(e){this.writer=e,this.name="EXT_mesh_gpu_instancing"}writeNode(e,t){if(!e.isInstancedMesh)return;const s=this.writer,n=e,o=new Float32Array(n.count*3),i=new Float32Array(n.count*4),a=new Float32Array(n.count*3),c=new Oe,l=new Y,p=new Xe,h=new Y;for(let u=0;u<n.count;u++)n.getMatrixAt(u,c),c.decompose(l,p,h),l.toArray(o,u*3),p.toArray(i,u*4),h.toArray(a,u*3);const y={TRANSLATION:s.processAccessor(new q(o,3)),ROTATION:s.processAccessor(new q(i,4)),SCALE:s.processAccessor(new q(a,3))};n.instanceColor&&(y._COLOR_0=s.processAccessor(n.instanceColor)),t.extensions=t.extensions||{},t.extensions[this.name]={attributes:y},s.extensionsUsed[this.name]=!0,s.extensionsRequired[this.name]=!0}}Me.Utils={insertKeyframe:function(r,e){const s=r.getValueSize(),n=new r.TimeBufferType(r.times.length+1),o=new r.ValueBufferType(r.values.length+s),i=r.createInterpolant(new r.ValueBufferType(s));let a;if(r.times.length===0){n[0]=e;for(let c=0;c<s;c++)o[c]=0;a=0}else if(e<r.times[0]){if(Math.abs(r.times[0]-e)<.001)return 0;n[0]=e,n.set(r.times,1),o.set(i.evaluate(e),0),o.set(r.values,s),a=0}else if(e>r.times[r.times.length-1]){if(Math.abs(r.times[r.times.length-1]-e)<.001)return r.times.length-1;n[n.length-1]=e,n.set(r.times,0),o.set(r.values,0),o.set(i.evaluate(e),r.values.length),a=n.length-1}else for(let c=0;c<r.times.length;c++){if(Math.abs(r.times[c]-e)<.001)return c;if(r.times[c]<e&&r.times[c+1]>e){n.set(r.times.slice(0,c+1),0),n[c+1]=e,n.set(r.times.slice(c+1),c+2),o.set(r.values.slice(0,(c+1)*s),0),o.set(i.evaluate(e),(c+1)*s),o.set(r.values.slice((c+1)*s),(c+2)*s),a=c+1;break}}return r.times=n,r.values=o,a},mergeMorphTargetTracks:function(r,e){const t=[],s={},n=r.tracks;for(let o=0;o<n.length;++o){let i=n[o];const a=ce.parseTrackName(i.name),c=ce.findNode(e,a.nodeName);if(a.propertyName!=="morphTargetInfluences"||a.propertyIndex===void 0){t.push(i);continue}if(i.createInterpolant!==i.InterpolantFactoryMethodDiscrete&&i.createInterpolant!==i.InterpolantFactoryMethodLinear){if(i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline)throw new Error("THREE.GLTFExporter: Cannot merge tracks with glTF CUBICSPLINE interpolation.");console.warn("THREE.GLTFExporter: Morph target interpolation mode not yet supported. Using LINEAR instead."),i=i.clone(),i.setInterpolation(ut)}const l=c.morphTargetInfluences.length,p=c.morphTargetDictionary[a.propertyIndex];if(p===void 0)throw new Error("THREE.GLTFExporter: Morph target name not found: "+a.propertyIndex);let h;if(s[c.uuid]===void 0){h=i.clone();const u=new h.ValueBufferType(l*h.times.length);for(let g=0;g<h.times.length;g++)u[g*l+p]=h.values[g];h.name=(a.nodeName||"")+".morphTargetInfluences",h.values=u,s[c.uuid]=h,t.push(h);continue}const y=i.createInterpolant(new i.ValueBufferType(1));h=s[c.uuid];for(let u=0;u<h.times.length;u++)h.values[u*l+p]=y.evaluate(h.times[u]);for(let u=0;u<i.times.length;u++){const g=this.insertKeyframe(h,i.times[u]);h.values[g*l+p]=i.values[u]}}return r.tracks=t,r}};const ne={characters:[{id:"player",name:"Player Character (Male)",module:"./src/objects/playerElement.js",createFn:"createPlayer",animated:!0},{id:"femalePlayer",name:"Player Character (Female)",module:"./src/objects/femalePlayerElement.js",createFn:"createFemalePlayer",animated:!0}],vehicles:[{id:"car",name:"Car",module:"./src/objects/vehicleElement.js",createFn:"createVehicleElement",args:["car"]},{id:"truck",name:"Truck",module:"./src/objects/vehicleElement.js",createFn:"createVehicleElement",args:["truck"]},{id:"bus",name:"Bus",module:"./src/objects/busElement.js",createFn:"createBus"},{id:"motorcycle",name:"Motorcycle",module:"./src/objects/motorcycleElement.js",createFn:"createMotorcycle"}],enemies:[{id:"normal",name:"Normal Zombie",module:"./src/objects/normalZombieElement.js",createFn:"createNormalZombie",animated:!0},{id:"fat",name:"Fat Zombie",module:"./src/objects/fatZombieElement.js",createFn:"createFatZombie",animated:!0},{id:"big",name:"Big Zombie",module:"./src/objects/bigZombieElement.js",createFn:"createBigZombie",animated:!0},{id:"slender",name:"Slenderman",module:"./src/objects/slendermanElement.js",createFn:"createSlenderman",animated:!0},{id:"spider",name:"Spider",module:"./src/objects/spiderElement.js",createFn:"createSpider",animated:!0}],buildings:[{id:"house",name:"House",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[1]},{id:"mansion",name:"Mansion",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[1.6]},{id:"cabin",name:"Cabin",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[.85]},{id:"smallBuilding",name:"Small Building",module:"./src/objects/smallBuildingElement.js",createFn:"createSmallBuildingElement"},{id:"plateau",name:"Plateau",module:"./src/objects/plateauElement.js",createFn:"createPlateauElement"}],rocks:[{id:"rock",name:"Rock",module:"./src/objects/rockElement.js",createFn:"createRockElement"},{id:"rockPillar",name:"Rock Pillar",module:"./src/objects/rockElement.js",createFn:"createRockPillarElement"},{id:"flatBoulder",name:"Flat Boulder",module:"./src/objects/rockElement.js",createFn:"createFlatBoulderElement"},{id:"crystalShard",name:"Crystal Shard",module:"./src/objects/rockElement.js",createFn:"createCrystalShardElement"}],trees:[{id:"oak",name:"Oak Tree",module:"./src/objects/treeOakElement.js",createFn:"createOakTree"},{id:"alpine",name:"Alpine/Pine Tree",module:"./src/objects/treeAlpineElement.js",createFn:"createAlpineTree"}],vegetation:[{id:"bush",name:"Bush",module:"./src/objects/bushElement.js",createFn:"createBush"}]};function rn(r={}){const{shirtColor:e=3447003,mouthStyle:t="serious",showHat:s=!0,showGlasses:n=!1,weapon:o="none"}=r,i=new B,a=new w({color:e}),c=new w({color:16764074}),l=new w({color:2899536}),p=new d(new m(.5,.5,.5),c);if(p.position.y=1.75,i.add(p),s){const R=new w({color:15158332}),O=new d(new m(.52,.1,.52),R);O.position.set(0,.3,0),p.add(O);const z=new d(new m(.52,.02,.35),R);z.position.set(0,.22,.35),p.add(z)}if(n){const R=new w({color:0}),O=new w({color:1710618,transparent:!0,opacity:.7,metalness:.8,roughness:.2}),z=new d(new m(.18,.12,.02),O);z.position.set(-.12,.05,.26),p.add(z);const H=new d(new m(.18,.12,.02),O);H.position.set(.12,.05,.26),p.add(H);const P=new d(new m(.08,.02,.02),R);P.position.set(0,.05,.26),p.add(P);const C=new d(new m(.02,.02,.3),R);C.position.set(-.21,.05,.1),p.add(C);const D=new d(new m(.02,.02,.3),R);D.position.set(.21,.05,.1),p.add(D)}const h=new w({color:0}),y=new d(new m(.06,.06,.02),h);y.position.set(-.1,.08,.26),p.add(y);const u=new d(new m(.06,.06,.02),h);u.position.set(.1,.08,.26),p.add(u);const g=an(t);g&&p.add(g);const f=new d(new m(.6,.8,.3),a);f.position.y=1.1,i.add(f);const M=new m(.2,.8,.2);M.translate(0,-.3,0);const v=new B;v.position.set(-.45,1.4,0),i.add(v);const F=new d(M,c);v.add(F);const j=new B;j.position.set(.45,1.4,0),i.add(j);const x=new d(M,c);j.add(x);const b=new m(.25,.8,.25);b.translate(0,-.4,0);const A=new B;A.position.set(-.15,.7,0),i.add(A);const _=new d(b,l);A.add(_);const N=new B;N.position.set(.15,.7,0),i.add(N);const Z=new d(b,l);if(N.add(Z),o&&o!=="none"){const R=cn(o);R&&(j.add(R),j.rotation.x=-Math.PI/2)}return i.traverse(R=>{R.isMesh&&(R.castShadow=!0,R.receiveShadow=!0)}),{mesh:i,leftArmPivot:v,rightArmPivot:j,leftLegPivot:A,rightLegPivot:N}}function an(r){const e=(r||"serious").toLowerCase(),t=new w({color:2824976,roughness:.6,metalness:0});let s=null;if(e==="smile"){const n=new B,o=t.clone(),i=new d(new m(.08,.04,.02),o),a=i.clone(),c=i.clone();i.position.set(-.1,-.15,.26),i.rotation.z=-.2,a.position.set(0,-.16,.26),c.position.set(.1,-.15,.26),c.rotation.z=.2,n.add(i,a,c),s=n}else if(e==="angry"){const n=new w({color:5901324,roughness:.4});s=new d(new m(.26,.05,.02),n),s.position.set(0,-.16,.26),s.rotation.z=-.18}else if(e==="surprised")s=new d(new oe(.06,.06,.02,20),t),s.position.set(0,-.14,.26),s.rotation.x=Math.PI/2;else{if(e==="none")return null;s=new d(new m(.22,.06,.02),t),s.position.set(0,-.16,.26)}return s}function cn(r){const e=r.toLowerCase();if(e==="pistol"){const t=new B,s=new d(new m(.12,.12,.35),new w({color:1710618,metalness:.8,roughness:.3}));s.position.set(0,-.28,.2);const n=new d(new m(.06,.06,.15),new w({color:657930,metalness:.9,roughness:.2}));n.position.set(0,-.28,.4);const o=new d(new m(.1,.25,.12),new w({color:2894892}));o.position.set(0,-.42,.15);const i=new d(new m(.03,.05,.03),new w({color:1710618}));return i.position.set(0,-.35,.18),t.add(s,n,o,i),t}if(e==="rifle"||e==="smg"||e==="shotgun"||e==="dmr"){const t=new B,s=new d(new m(.08,.08,.9),new w({color:1710618,metalness:.8,roughness:.3}));s.position.set(0,-.28,.45);const n=new d(new m(.12,.14,.4),new w({color:2894892}));n.position.set(0,-.3,.2);const o=new d(new m(.1,.22,.12),new w({color:2894892}));o.position.set(0,-.44,.15);const i=new d(new m(.1,.12,.25),new w({color:3815994}));i.position.set(0,-.28,-.1);const a=new d(new m(.08,.25,.1),new w({color:1710618}));return a.position.set(0,-.5,.2),t.add(s,n,o,i,a),e==="smg"?(t.scale.set(.8,.8,.8),n.material.color.setHex(5598095)):e==="shotgun"?(t.scale.set(1.1,1,.8),n.material.color.setHex(9132587)):e==="dmr"&&(t.scale.set(.95,.95,1),n.material.color.setHex(3050327)),t}if(e==="sniper"){const t=new B,s=new d(new m(.08,.08,1.3),new w({color:1727514,metalness:.6,roughness:.4}));s.position.set(0,-.28,.65);const n=new d(new m(.14,.16,.5),new w({color:2969622}));n.position.set(0,-.3,.25);const o=new d(new oe(.06,.06,.35,8),new w({color:657930,metalness:.9,roughness:.1}));o.rotation.z=Math.PI/2,o.position.set(0,-.18,.4);const i=new d(new m(.12,.14,.3),new w({color:3811866}));return i.position.set(0,-.28,-.05),t.add(s,n,o,i),t}return null}const je=Object.freeze(Object.defineProperty({__proto__:null,createPlayer:rn},Symbol.toStringTag,{value:"Module"}));function ln(r={}){const{shirtColor:e=15277667,hairColor:t=9127187,hairStyle:s="long",mouthStyle:n="smile",showEarrings:o=!0,showGlasses:i=!1,weapon:a="none"}=r,c=new B,l=new w({color:e}),p=new w({color:16764074}),h=new w({color:4854924}),y=new w({color:t}),u=new d(new m(.45,.45,.45),p);if(u.position.y=1.75,c.add(u),dn(u,s,y),o){const P=new w({color:16766720,metalness:.9,roughness:.1}),C=new d(new le(.04,8,8),P);C.position.set(-.25,.05,0),u.add(C);const D=new d(new le(.04,8,8),P);D.position.set(.25,.05,0),u.add(D)}if(i){const P=new w({color:0}),C=new w({color:1710618,transparent:!0,opacity:.7,metalness:.8,roughness:.2}),D=new d(new m(.16,.11,.02),C);D.position.set(-.11,.05,.24),u.add(D);const V=new d(new m(.16,.11,.02),C);V.position.set(.11,.05,.24),u.add(V);const Ie=new d(new m(.06,.02,.02),P);Ie.position.set(0,.05,.24),u.add(Ie);const ve=new d(new m(.02,.02,.28),P);ve.position.set(-.19,.05,.08),u.add(ve);const Ae=new d(new m(.02,.02,.28),P);Ae.position.set(.19,.05,.08),u.add(Ae)}const g=new w({color:0}),f=new d(new m(.06,.06,.02),g);f.position.set(-.1,.08,.23),u.add(f);const M=new d(new m(.06,.06,.02),g);M.position.set(.1,.08,.23),u.add(M);const v=un(n);v&&u.add(v);const F=new d(new m(.5,.5,.28),l);F.position.y=1.25,c.add(F);const j=new d(new m(.45,.3,.26),l);j.position.y=.95,c.add(j);const x=new m(.18,.75,.18);x.translate(0,-.28,0);const b=new B;b.position.set(-.38,1.4,0),c.add(b);const A=new d(x,p);b.add(A);const _=new B;_.position.set(.38,1.4,0),c.add(_);const N=new d(x,p);_.add(N);const Z=new m(.22,.75,.22);Z.translate(0,-.38,0);const R=new B;R.position.set(-.13,.75,0),c.add(R);const O=new d(Z,h);R.add(O);const z=new B;z.position.set(.13,.75,0),c.add(z);const H=new d(Z,h);if(z.add(H),a&&a!=="none"){const P=hn(a);P&&(_.add(P),_.rotation.x=-Math.PI/2)}return c.traverse(P=>{P.isMesh&&(P.castShadow=!0,P.receiveShadow=!0)}),{mesh:c,leftArmPivot:b,rightArmPivot:_,leftLegPivot:R,rightLegPivot:z}}function dn(r,e,t){const s=(e||"long").toLowerCase();if(s==="long"){const n=new d(new m(.48,.12,.48),t);n.position.set(0,.28,0),r.add(n);const o=new d(new m(.48,.6,.12),t);o.position.set(0,-.05,-.28),r.add(o);const i=new d(new m(.12,.5,.35),t);i.position.set(-.28,-.02,0),r.add(i);const a=new d(new m(.12,.5,.35),t);a.position.set(.28,-.02,0),r.add(a)}else if(s==="ponytail"){const n=new d(new m(.48,.12,.48),t);n.position.set(0,.28,0),r.add(n);const o=new d(new m(.2,.15,.2),t);o.position.set(0,.15,-.28),r.add(o);const i=new d(new m(.15,.5,.15),t);i.position.set(0,-.15,-.35),i.rotation.x=.3,r.add(i)}else if(s==="bun"){const n=new d(new m(.48,.12,.48),t);n.position.set(0,.28,0),r.add(n);const o=new d(new le(.15,8,8),t);o.position.set(0,.32,-.15),r.add(o);const i=new d(new m(.12,.3,.35),t);i.position.set(-.28,.05,0),r.add(i);const a=new d(new m(.12,.3,.35),t);a.position.set(.28,.05,0),r.add(a)}else if(s==="short"){const n=new d(new m(.48,.12,.48),t);n.position.set(0,.28,0),r.add(n);const o=new d(new m(.48,.25,.12),t);o.position.set(0,.1,-.28),r.add(o);const i=new d(new m(.12,.25,.35),t);i.position.set(-.28,.1,0),r.add(i);const a=new d(new m(.12,.25,.35),t);a.position.set(.28,.1,0),r.add(a)}}function un(r){const e=(r||"smile").toLowerCase(),t=new w({color:15277667,roughness:.4,metalness:0});let s=null;if(e==="smile"){const n=new B,o=t.clone(),i=new d(new m(.07,.04,.02),o),a=i.clone(),c=i.clone();i.position.set(-.09,-.14,.23),i.rotation.z=-.25,a.position.set(0,-.15,.23),c.position.set(.09,-.14,.23),c.rotation.z=.25,n.add(i,a,c),s=n}else if(e==="angry"){const n=new w({color:12720219,roughness:.4});s=new d(new m(.22,.04,.02),n),s.position.set(0,-.15,.23),s.rotation.z=-.15}else if(e==="surprised")s=new d(new oe(.05,.05,.02,16),t),s.position.set(0,-.13,.23),s.rotation.x=Math.PI/2;else{if(e==="none")return null;s=new d(new m(.18,.05,.02),t),s.position.set(0,-.15,.23)}return s}function hn(r){const e=r.toLowerCase();if(e==="pistol"){const t=new B,s=new d(new m(.12,.12,.35),new w({color:1710618,metalness:.8,roughness:.3}));s.position.set(0,-.28,.2);const n=new d(new m(.06,.06,.15),new w({color:657930,metalness:.9,roughness:.2}));n.position.set(0,-.28,.4);const o=new d(new m(.1,.25,.12),new w({color:2894892}));o.position.set(0,-.42,.15);const i=new d(new m(.03,.05,.03),new w({color:1710618}));return i.position.set(0,-.35,.18),t.add(s,n,o,i),t}if(e==="rifle"||e==="smg"||e==="shotgun"||e==="dmr"){const t=new B,s=new d(new m(.08,.08,.9),new w({color:1710618,metalness:.8,roughness:.3}));s.position.set(0,-.28,.45);const n=new d(new m(.12,.14,.4),new w({color:2894892}));n.position.set(0,-.3,.2);const o=new d(new m(.1,.22,.12),new w({color:2894892}));o.position.set(0,-.44,.15);const i=new d(new m(.1,.12,.25),new w({color:3815994}));i.position.set(0,-.28,-.1);const a=new d(new m(.08,.25,.1),new w({color:1710618}));return a.position.set(0,-.5,.2),t.add(s,n,o,i,a),e==="smg"?(t.scale.set(.8,.8,.8),n.material.color.setHex(5598095)):e==="shotgun"?(t.scale.set(1.1,1,.8),n.material.color.setHex(9132587)):e==="dmr"&&(t.scale.set(.95,.95,1),n.material.color.setHex(3050327)),t}if(e==="sniper"){const t=new B,s=new d(new m(.08,.08,1.3),new w({color:1727514,metalness:.6,roughness:.4}));s.position.set(0,-.28,.65);const n=new d(new m(.14,.16,.5),new w({color:2969622}));n.position.set(0,-.3,.25);const o=new d(new oe(.06,.06,.35,8),new w({color:657930,metalness:.9,roughness:.1}));o.rotation.z=Math.PI/2,o.position.set(0,-.18,.4);const i=new d(new m(.12,.14,.3),new w({color:3811866}));return i.position.set(0,-.28,-.05),t.add(s,n,o,i),t}return null}const ze=Object.freeze(Object.defineProperty({__proto__:null,createFemalePlayer:ln},Symbol.toStringTag,{value:"Module"}));function mn(r=1){const e=new B,t=new w({color:2924588,roughness:1}),s=2+Math.floor(Math.random()*3);for(let n=0;n<s;n++){const o=(1.2+Math.random()*1)*r,i=new d(new le(o,6,6),t);i.position.set((Math.random()-.5)*1.2*r,o*.65,(Math.random()-.5)*1.2*r),i.castShadow=!0,e.add(i)}return e}const Ge=Object.freeze(Object.defineProperty({__proto__:null,createBush:mn},Symbol.toStringTag,{value:"Module"})),pn={"./src/objects/playerElement.js":je,"./src/objects/femalePlayerElement.js":ze,"./src/objects/vehicleElement.js":_t,"./src/objects/busElement.js":Lt,"./src/objects/motorcycleElement.js":St,"./src/objects/normalZombieElement.js":Et,"./src/objects/fatZombieElement.js":xt,"./src/objects/bigZombieElement.js":yt,"./src/objects/slendermanElement.js":wt,"./src/objects/spiderElement.js":At,"./src/objects/houseElement.js":Bt,"./src/objects/smallBuildingElement.js":Ft,"./src/objects/plateauElement.js":kt,"./src/objects/rockElement.js":vt,"./src/objects/treeOakElement.js":It,"./src/objects/treeAlpineElement.js":Tt,"./src/objects/bushElement.js":Ge},I=new re;I.background=new ae(2962486);I.fog=new ht(2962486,10,60);const k=new Ne(75,window.innerWidth/window.innerHeight,.1,1e3);k.position.set(5,4,5);const X=new ke({antialias:!0});X.setSize(window.innerWidth,window.innerHeight);X.shadowMap.enabled=!0;X.shadowMap.type=mt;document.getElementById("canvas-container").appendChild(X.domElement);const U=new Rt(k,X.domElement);U.enableDamping=!0;U.dampingFactor=.05;U.target.set(0,1,0);const Ee=new pt(16777215,.6);I.add(Ee);const K=new ft(16777215,1);K.position.set(10,20,10);K.castShadow=!0;K.shadow.mapSize.width=2048;K.shadow.mapSize.height=2048;I.add(K);const fn=new Pe(60,60),gn=new w({color:4020864,roughness:.8,metalness:.2}),de=new d(fn,gn);de.rotation.x=-Math.PI/2;de.receiveShadow=!0;de.position.y=-.01;I.add(de);const wn=new gt(60,60,6610911,2699841);I.add(wn);let E=null,S=null,L=null,be="idle",se=1,we=!1,ye=!1;class ue{constructor(e,t){this.mesh=e.mesh,this.type=t,this.baseY=this.mesh.position.y,this.animTime=0,this.leftArmPivot=e.leftArmPivot,this.rightArmPivot=e.rightArmPivot,this.leftLegPivot=e.leftLegPivot,this.rightLegPivot=e.rightLegPivot,this.legs=e.legs,this.abdomen=e.abdomen,this.head=e.head}update(e,t){this.animTime+=e*10,this.type==="spider"?this.animateSpider(t):t==="idle"?this.animateIdle():t==="walk"?this.animateWalk():t==="attack"?this.animateAttack():t==="jump"&&this.animateJump(e)}animateSpider(e){if(this.legs){if(e==="idle")this.legs.forEach(t=>{if(t.index===0){const s=t.side===0?1.5:1.2,n=t.side===0?0:1,o=Math.sin(this.animTime*s+n)*.2;t.upper.rotation.x=-Math.PI/4+o,t.lower.rotation.x=Math.PI/1.2-o*.5}else{const s=Math.sin(this.animTime*.5+t.index)*.05;t.upper.rotation.x=-Math.PI/4+s,t.lower.rotation.x=Math.PI/1.2}}),this.mesh.position.y=this.baseY+Math.sin(this.animTime)*.02;else if(e==="walk")this.legs.forEach(t=>{const n=(t.side+t.index)%2===0?0:Math.PI,o=Math.sin(this.animTime*2+n);t.upper.rotation.x=-Math.PI/4+o*.15,t.lower.rotation.x=Math.PI/1.2+o*.1,t.upper.parent&&(t.upper.parent.rotation.z=o*.2)}),this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime*2))*.04;else if(e==="attack")this.legs.forEach(t=>{if(t.index===0){const s=(Math.sin(this.animTime*3)+1)/2;t.upper.rotation.x=-Math.PI/4-s*.6,t.lower.rotation.x=Math.PI/1.2-s*.4,t.upper.parent&&(t.upper.parent.rotation.z=-s*1.2)}}),this.head&&(this.head.rotation.x=Math.sin(this.animTime*3)*.3);else if(e==="jump"){const t=Math.abs(Math.sin(this.animTime*1));this.mesh.position.y=this.baseY+t*2,this.legs.forEach(s=>{const n=Math.sin(this.animTime*1);s.upper.rotation.x=-Math.PI/4+n*.3,s.lower.rotation.x=Math.PI/1.2-n*.3})}}}animateIdle(){this.leftArmPivot&&(this.leftArmPivot.rotation.x=Math.sin(this.animTime)*.1),this.rightArmPivot&&(this.rightArmPivot.rotation.x=-Math.sin(this.animTime)*.1),this.leftLegPivot&&(this.leftLegPivot.rotation.x=0),this.rightLegPivot&&(this.rightLegPivot.rotation.x=0),this.mesh.position.y=this.baseY+Math.sin(this.animTime*2)*.02}animateWalk(){const e=Math.sin(this.animTime)*.5;this.leftLegPivot&&(this.leftLegPivot.rotation.x=e),this.rightLegPivot&&(this.rightLegPivot.rotation.x=-e),this.leftArmPivot&&(this.leftArmPivot.rotation.x=-e*.8),this.rightArmPivot&&(this.rightArmPivot.rotation.x=e*.8),this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime))*.05}animateAttack(){const e=(Math.sin(this.animTime*3)+1)/2,t=-Math.PI/2*e;this.leftArmPivot&&(this.leftArmPivot.rotation.x=t),this.rightArmPivot&&(this.rightArmPivot.rotation.x=t)}animateJump(e){this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime*2))*.5}}const yn=document.getElementById("categories");Object.keys(ne).forEach(r=>{const e=document.createElement("div");e.className="category-group";const t=document.createElement("div");t.className="category-title",t.innerHTML=`<span>${r}</span> <span>${ne[r].length}</span>`;const s=document.createElement("div");if(s.className="object-list",r==="characters"&&s.classList.add("active"),t.onclick=()=>{document.querySelectorAll(".object-list").forEach(n=>n.classList.remove("active")),s.classList.add("active")},r==="enemies"){const n=document.createElement("div");n.className="object-item",n.style.background="rgba(100, 223, 223, 0.2)",n.style.fontWeight="bold",n.innerHTML='<span class="icon"></span> View All Enemies',n.onclick=()=>xn(),s.appendChild(n)}ne[r].forEach(n=>{const o=document.createElement("div");o.className="object-item",o.dataset.id=n.id,o.innerHTML=`<span class="icon"></span> ${n.name}`,o.onclick=()=>De(n),s.appendChild(o)}),e.appendChild(t),e.appendChild(s),yn.appendChild(e)});function He(){E&&(I.remove(E),E=null),Array.isArray(S)?(S.forEach(r=>{r.mesh&&I.remove(r.mesh)}),S=null):S&&(S.mesh&&I.remove(S.mesh),S=null),document.querySelectorAll(".enemy-label").forEach(r=>r.remove())}async function De(r){const e=document.getElementById("loading");if(e&&e.classList.remove("hidden"),document.querySelectorAll(".object-item").forEach(t=>t.classList.remove("active")),typeof event<"u"&&event&&typeof event.target<"u"&&event.target){const t=event.target.closest(".object-item");t&&t.classList.add("active")}document.getElementById("object-name").textContent=r.name,document.getElementById("object-type").textContent=r.id,He();try{const t=pn[r.module];if(!t)throw new Error(`Module not found in map: ${r.module}`);const s=t[r.createFn];if(!s)throw new Error(`Function ${r.createFn} not found in module`);const n=r.args||[];let o;if(r.id==="car"||r.id==="truck"?o=s(...n):r.id==="bus"||r.id==="motorcycle"?o=s():r.id==="player"?o=s({shirtColor:3447003,mouthStyle:"serious",showHat:!0,showGlasses:!1,weapon:"none"}):r.id==="femalePlayer"?o=s({shirtColor:15277667,hairColor:9127187,hairStyle:"long",mouthStyle:"smile",showEarrings:!0,showGlasses:!1,weapon:"none"}):r.module.includes("rockElement")?o=s(0,0,0):r.module.includes("houseElement")||r.module.includes("smallBuildingElement")||r.module.includes("plateauElement")?o=s(...n):r.module.includes("treeOakElement")||r.module.includes("treeAlpineElement")||r.module.includes("bushElement")?o=s():o=s(I,0,0,0,...n),o.isObject3D)E=o;else if(o.mesh)E=o.mesh,r.animated&&(S=new ue(o,r.id));else throw console.error("Unknown object format:",o),new Error("Object format not recognized (must be Object3D or have .mesh property)");const i=new $().setFromObject(E);if(!i.isEmpty()){const h=i.min.y;E.position.y-=h,E.updateMatrix(),E.updateWorldMatrix(!0,!0)}I.add(E);const a=document.getElementById("anim-controls"),c=document.getElementById("anim-speed-control");a&&c&&(r.animated?(a.style.display="block",c.style.display="block"):(a.style.display="none",c.style.display="none"));const l={vehicle:document.getElementById("vehicle-color-control"),house:document.getElementById("house-color-control"),bush:document.getElementById("bush-scale-control"),bus:document.getElementById("bus-scale-control"),player:document.getElementById("player-controls"),femalePlayer:document.getElementById("female-player-controls")};Object.values(l).forEach(h=>{h&&(h.style.display="none")}),r.id==="car"||r.id==="truck"?l.vehicle&&(l.vehicle.style.display="block"):r.module.includes("houseElement")||r.module.includes("smallBuildingElement")||r.module.includes("plateauElement")?l.house&&(l.house.style.display="block"):r.module.includes("bushElement")?l.bush&&(l.bush.style.display="block"):r.id==="bus"?l.bus&&(l.bus.style.display="block"):r.id==="player"?l.player&&(l.player.style.display="block"):r.id==="femalePlayer"&&l.femalePlayer&&(l.femalePlayer.style.display="block"),L=r,Te(E);const p={plateau:27,mansion:35,smallBuilding:21};if(p[r.id]){const y=new $().setFromObject(E).getCenter(new Y),u=p[r.id],g=new Y().subVectors(k.position,y).normalize();k.position.copy(y).add(g.multiplyScalar(u)),k.lookAt(y),U.target.copy(y),U.update();const f=document.getElementById("zoom-slider"),M=document.getElementById("zoom-value");f&&M&&(f.value=u,M.textContent=u.toFixed(1))}typeof toggleBoundingBox=="function"&&toggleBoundingBox()}catch(t){console.error("Error loading object:",t),alert("Failed to load object: "+t.message)}finally{e&&e.classList.add("hidden")}}function Te(r){const e=new $().setFromObject(r),t=e.getCenter(new Y),s=e.getSize(new Y),n=Math.max(s.x,s.y,s.z),o=k.fov*(Math.PI/180);let i=Math.abs(n/2*Math.tan(o*2));i=Math.max(i,n*1.5),n>20&&(i*=1.2);const a=i;k.position.set(t.x+a,t.y+a*.5,t.z+a),k.lookAt(t),U.target.copy(t),U.update();const c=k.position.distanceTo(t),l=document.getElementById("zoom-slider"),p=document.getElementById("zoom-value");l&&p&&(l.value=c,p.textContent=c.toFixed(1))}window.resetCamera=()=>{E?Te(E):(k.position.set(5,4,5),U.target.set(0,1,0))};window.toggleRotation=()=>{we=!we,U.autoRotate=we};window.toggleDayNight=()=>{ye=!ye,ye?(I.background=new ae(657930),I.fog.color.set(657930),Ee.intensity=.1,K.intensity=.2):(I.background=new ae(2962486),I.fog.color.set(2962486),Ee.intensity=.6,K.intensity=1)};let ee=null;window.toggleBoundingBox=()=>{const r=document.getElementById("show-bounding-box");if(ee&&(I.remove(ee),ee=null),r.checked){const e=new $;let t=!1;const s=n=>{n&&n.traverse(o=>{if(o.isMesh&&o.geometry&&(o.geometry.boundingBox||o.geometry.computeBoundingBox(),o.geometry.boundingBox)){const i=o.geometry.boundingBox.clone();o.updateWorldMatrix(!0,!1),i.applyMatrix4(o.matrixWorld),e.union(i),t=!0}})};Array.isArray(S)?S.forEach(n=>{n.mesh&&s(n.mesh)}):E&&s(E),t&&!e.isEmpty()&&(ee=new Mt(e,16776960),I.add(ee))}};window.exportGLTF=()=>{const r=new Me;let e=E;if(Array.isArray(S))e=new B,S.forEach(t=>{t.mesh&&e.add(t.mesh.clone())});else if(e)e=e.clone();else{alert("No object to export!");return}e.traverse(t=>{if(t.isMesh&&t.material){const n=t.material.clone();n.metalness!==void 0&&(n.metalness=0),n.roughness!==void 0&&(n.roughness=1),t.material=n}}),r.parse(e,t=>{const s=new Blob([t],{type:"application/octet-stream"}),n=URL.createObjectURL(s),o=document.createElement("a");o.style.display="none",o.href=n,o.download=(L?L.id:"scene")+".glb",document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)},t=>{console.error("An error happened during GLTF export:",t),alert("Export failed: "+t.message)},{binary:!0})};window.applyVehicleColor=async()=>{if(!L||L.id!=="car"&&L.id!=="truck")return;const e=document.getElementById("vehicle-color").value,t=parseInt(e.slice(1),16),s={...L,customColor:t};await Ve(s)};window.randomVehicleColor=async()=>{if(!L||L.id!=="car"&&L.id!=="truck")return;const r=[1668818,15921906,1118481,9116186,15022389,15844367,48340,16733986,5025616],e=r[Math.floor(Math.random()*r.length)];document.getElementById("vehicle-color").value="#"+e.toString(16).padStart(6,"0"),await applyVehicleColor()};document.getElementById("bush-scale").addEventListener("input",r=>{document.getElementById("bush-scale-value").textContent=parseFloat(r.target.value).toFixed(1)});window.applyBushScale=async()=>{if(!L||L.id!=="bush")return;const r=document.getElementById("bush-scale"),e=parseFloat(r.value);E&&(I.remove(E),E=null),S=null;try{const s=(await W(()=>Promise.resolve().then(()=>Ge),void 0)).createBush;E=s(e),I.add(E)}catch(t){console.error("Error reloading bush with scale:",t)}};document.getElementById("bus-scale").addEventListener("input",r=>{document.getElementById("bus-scale-value").textContent=parseFloat(r.target.value).toFixed(1)});window.applyBusScale=async()=>{if(!L||L.id!=="bus")return;const r=document.getElementById("bus-scale"),e=parseFloat(r.value);E&&(I.remove(E),E=null),S=null;try{const s=(await W(()=>import("./spiderElement-CcVWrlae.js").then(o=>o.n),__vite__mapDeps([0,1]))).createBus;E=s(e),I.add(E)}catch(t){console.error("Error reloading bus with scale:",t)}};window.applyPlayerSettings=async()=>{if(!L||L.id!=="player")return;const r=document.getElementById("player-shirt-color").value,e=document.getElementById("player-mouth").value,t=document.getElementById("player-hat").checked,s=document.getElementById("player-glasses").checked,n=document.getElementById("player-weapon").value;E&&(I.remove(E),E=null),S=null;try{const i=(await W(()=>Promise.resolve().then(()=>je),void 0)).createPlayer,a=i({shirtColor:parseInt(r.replace("#","0x")),mouthStyle:e,showHat:t,showGlasses:s,weapon:n});a.mesh?(E=a.mesh,L.animated&&(S=new ue(a,L.id))):E=a,I.add(E)}catch(o){console.error("Error reloading player with settings:",o)}};window.applyFemalePlayerSettings=async()=>{if(!L||L.id!=="femalePlayer")return;const r=document.getElementById("female-shirt-color").value,e=document.getElementById("female-hair-color").value,t=document.getElementById("female-hair-style").value,s=document.getElementById("female-mouth").value,n=document.getElementById("female-earrings").checked,o=document.getElementById("female-glasses").checked,i=document.getElementById("female-weapon").value;E&&(I.remove(E),E=null),S=null;try{const c=(await W(()=>Promise.resolve().then(()=>ze),void 0)).createFemalePlayer,l=c({shirtColor:parseInt(r.replace("#","0x")),hairColor:parseInt(e.replace("#","0x")),hairStyle:t,mouthStyle:s,showEarrings:n,showGlasses:o,weapon:i});l.mesh?(E=l.mesh,L.animated&&(S=new ue(l,L.id))):E=l,I.add(E)}catch(a){console.error("Error reloading female player with settings:",a)}};window.applyHouseColors=async()=>{if(!L||!["house","mansion","cabin"].includes(L.id))return;const r=document.getElementById("wall-color"),e=document.getElementById("roof-color"),t=parseInt(r.value.slice(1),16),s=parseInt(e.value.slice(1),16),n={...L,customWallColor:t,customRoofColor:s};await Ve(n)};async function Ve(r){E&&(I.remove(E),E=null),S=null;try{const t=(await import(r.module))[r.createFn],s=r.args||[];let n;if(r.id==="car"||r.id==="truck")n=t(s[0]||r.id,r.customColor||null);else if(["house","mansion","cabin"].includes(r.id))n=t(s[0]||1,r.customWallColor,r.customRoofColor);else return;n.isObject3D?E=n:n.mesh?E=n.mesh:console.error("Unknown object format:",n);const o=new $().setFromObject(E);if(!o.isEmpty()){const i=o.min.y;E.position.y-=i,E.updateMatrix(),E.updateWorldMatrix(!0,!0)}I.add(E),Te(E)}catch(e){console.error("Error reloading object with color:",e)}}async function xn(){document.querySelectorAll(".object-item").forEach(r=>r.classList.remove("active")),event.target.closest(".object-item").classList.add("active"),document.getElementById("object-name").textContent="All Enemies",document.getElementById("object-type").textContent="Group View",He(),document.getElementById("anim-controls").style.display="block",document.getElementById("anim-speed-control").style.display="block",document.getElementById("vehicle-color-control").style.display="none",document.getElementById("house-color-control").style.display="none";try{const{createNormalZombie:r}=await W(async()=>{const{createNormalZombie:a}=await import("./slendermanElement-CLgnoac4.js").then(c=>c.al);return{createNormalZombie:a}},[]),{createFatZombie:e}=await W(async()=>{const{createFatZombie:a}=await import("./slendermanElement-CLgnoac4.js").then(c=>c.ak);return{createFatZombie:a}},[]),{createBigZombie:t}=await W(async()=>{const{createBigZombie:a}=await import("./slendermanElement-CLgnoac4.js").then(c=>c.aj);return{createBigZombie:a}},[]),{createSlenderman:s}=await W(async()=>{const{createSlenderman:a}=await import("./slendermanElement-CLgnoac4.js").then(c=>c.ai);return{createSlenderman:a}},[]),{createSpider:n}=await W(async()=>{const{createSpider:a}=await import("./spiderElement-CcVWrlae.js").then(c=>c.s);return{createSpider:a}},__vite__mapDeps([0,1])),o=[],i=[{type:"normal",x:-8,name:"Normal Zombie",createFn:r},{type:"fat",x:-4,name:"Fat Zombie",createFn:e},{type:"big",x:0,name:"Big Zombie",createFn:t},{type:"slender",x:4,name:"Slenderman",createFn:s},{type:"spider",x:8,name:"Spider",createFn:n}];document.querySelectorAll(".enemy-label").forEach(a=>a.remove()),i.forEach(({type:a,x:c,name:l,createFn:p})=>{const h=p(I,c,0,0),y=new $().setFromObject(h.mesh);if(!y.isEmpty()){const f=y.min.y;h.mesh.position.y-=f,h.mesh.updateMatrix(),h.mesh.updateWorldMatrix(!0,!0)}const u=new ue(h,a);u.enemyType=a,u.enemyName=l,o.push(u);const g=document.createElement("div");g.className="enemy-label",g.textContent=l,g.id=`enemy-label-${a}`,document.body.appendChild(g)}),S=o,L=null,k.position.set(0,4,15),U.target.set(0,2,0),U.update()}catch(r){console.error("Error loading all enemies:",r),alert("Failed to load all enemies: "+r.message)}}function En(){Array.isArray(S)&&S.forEach(r=>{if(!r.enemyType||!r.mesh)return;const e=r.mesh.position.clone(),t=r.enemyType==="slender"?3.5:r.enemyType==="big"?5:r.enemyType==="spider"?1.5:2.5;e.y+=t,e.project(k);const s=(e.x*.5+.5)*window.innerWidth,n=(-(e.y*.5)+.5)*window.innerHeight,o=document.getElementById(`enemy-label-${r.enemyType}`);o&&(o.style.left=s+"px",o.style.top=n+"px")})}document.querySelectorAll("[data-anim]").forEach(r=>{r.addEventListener("click",e=>{document.querySelectorAll("[data-anim]").forEach(t=>t.classList.remove("active")),e.target.classList.add("active"),be=e.target.dataset.anim})});document.getElementById("anim-speed").addEventListener("input",r=>{se=parseFloat(r.target.value),document.getElementById("speed-value").textContent=se.toFixed(1)});document.getElementById("zoom-slider").addEventListener("input",r=>{const e=parseFloat(r.target.value);document.getElementById("zoom-value").textContent=e.toFixed(1);const t=new Y().subVectors(k.position,U.target).normalize();k.position.copy(U.target).add(t.multiplyScalar(e)),U.update()});U.addEventListener("change",()=>{const r=k.position.distanceTo(U.target),e=document.getElementById("zoom-slider"),t=document.getElementById("zoom-value");e&&t&&document.activeElement!==e&&(e.value=r,t.textContent=r.toFixed(1))});window.addEventListener("resize",()=>{k.aspect=window.innerWidth/window.innerHeight,k.updateProjectionMatrix(),X.setSize(window.innerWidth,window.innerHeight)});const bn=new bt;function We(){requestAnimationFrame(We);const r=bn.getDelta();S&&se>0&&(Array.isArray(S)?(S.forEach(e=>{e.update(r*se,be)}),En()):S.update(r*se,be)),U.update(),X.render(I,k)}We();(async()=>{const r=document.getElementById("loading");try{if(ne.characters){const e=ne.characters.find(t=>t.id==="player");if(e){console.log("Loading default object:",e),await De(e);const t=document.querySelector('.object-item[data-id="player"]');t&&(document.querySelectorAll(".object-item").forEach(s=>s.classList.remove("active")),t.classList.add("active"))}}}catch(e){console.error("Error loading default object:",e)}r&&r.classList.add("hidden")})();
