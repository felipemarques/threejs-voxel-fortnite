const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/bushElement-BmJBkeri.js","assets/three.module-BS1HX5LR.js","assets/busElement-DikC1tJ7.js","assets/playerElement-DDZppg7c.js","assets/femalePlayerElement-D5Uxa6Yv.js","assets/normalZombieElement-DnB3_ElI.js","assets/fatZombieElement-CN_k09VM.js","assets/bigZombieElement-BwYxHNPs.js","assets/slendermanElement-xZvndKHS.js","assets/spiderElement-hFDYL3-m.js"])))=>i.map(i=>d[i]);
import{y as H,e as M,F as W,K as N,W as G,Q as q,H as Y,J as $,P as J,M as U,a as K,g as Q,l as O,V as B,O as X}from"./three.module-BS1HX5LR.js";import{_ as g}from"./preload-helper-B0g6gzln.js";import{O as D}from"./OrbitControls-D4dm4C8n.js";const I={characters:[{id:"player",name:"Player Character (Male)",module:"./src/objects/playerElement.js",createFn:"createPlayer",animated:!0},{id:"femalePlayer",name:"Player Character (Female)",module:"./src/objects/femalePlayerElement.js",createFn:"createFemalePlayer",animated:!0}],vehicles:[{id:"car",name:"Car",module:"./src/objects/vehicleElement.js",createFn:"createVehicleElement",args:["car"]},{id:"truck",name:"Truck",module:"./src/objects/vehicleElement.js",createFn:"createVehicleElement",args:["truck"]},{id:"bus",name:"Bus",module:"./src/objects/busElement.js",createFn:"createBus"},{id:"motorcycle",name:"Motorcycle",module:"./src/objects/motorcycleElement.js",createFn:"createMotorcycle"}],enemies:[{id:"normal",name:"Normal Zombie",module:"./src/objects/normalZombieElement.js",createFn:"createNormalZombie",animated:!0},{id:"fat",name:"Fat Zombie",module:"./src/objects/fatZombieElement.js",createFn:"createFatZombie",animated:!0},{id:"big",name:"Big Zombie",module:"./src/objects/bigZombieElement.js",createFn:"createBigZombie",animated:!0},{id:"slender",name:"Slenderman",module:"./src/objects/slendermanElement.js",createFn:"createSlenderman",animated:!0},{id:"spider",name:"Spider",module:"./src/objects/spiderElement.js",createFn:"createSpider",animated:!0}],buildings:[{id:"house",name:"House",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[1]},{id:"mansion",name:"Mansion",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[1.6]},{id:"cabin",name:"Cabin",module:"./src/objects/houseElement.js",createFn:"createHouseElement",args:[.85]},{id:"smallBuilding",name:"Small Building",module:"./src/objects/smallBuildingElement.js",createFn:"createSmallBuildingElement"},{id:"plateau",name:"Plateau",module:"./src/objects/plateauElement.js",createFn:"createPlateauElement"}],rocks:[{id:"rock",name:"Rock",module:"./src/objects/rockElement.js",createFn:"createRockElement"},{id:"rockPillar",name:"Rock Pillar",module:"./src/objects/rockElement.js",createFn:"createRockPillarElement"},{id:"flatBoulder",name:"Flat Boulder",module:"./src/objects/rockElement.js",createFn:"createFlatBoulderElement"},{id:"crystalShard",name:"Crystal Shard",module:"./src/objects/rockElement.js",createFn:"createCrystalShardElement"}],trees:[{id:"oak",name:"Oak Tree",module:"./src/objects/treeOakElement.js",createFn:"createOakTree"},{id:"alpine",name:"Alpine/Pine Tree",module:"./src/objects/treeAlpineElement.js",createFn:"createAlpineTree"}],vegetation:[{id:"bush",name:"Bush",module:"./src/objects/bushElement.js",createFn:"createBush"}]},r=new H;r.background=new M(2962486);r.fog=new W(2962486,10,60);const u=new N(75,window.innerWidth/window.innerHeight,.1,1e3);u.position.set(5,4,5);const v=new G({antialias:!0});v.setSize(window.innerWidth,window.innerHeight);v.shadowMap.enabled=!0;v.shadowMap.type=q;document.getElementById("canvas-container").appendChild(v.domElement);const h=new D(u,v.domElement);h.enableDamping=!0;h.dampingFactor=.05;h.target.set(0,1,0);const A=new Y(16777215,.6);r.add(A);const w=new $(16777215,1);w.position.set(10,20,10);w.castShadow=!0;w.shadow.mapSize.width=2048;w.shadow.mapSize.height=2048;r.add(w);const ee=new J(60,60),te=new U({color:4020864,roughness:.8,metalness:.2}),C=new K(ee,te);C.rotation.x=-Math.PI/2;C.receiveShadow=!0;C.position.y=-.01;r.add(C);const ne=new Q(60,60,6610911,2699841);r.add(ne);let s=null,d=null,c=null,L="idle",P=1,k=!1,S=!1;class F{constructor(n,t){this.mesh=n.mesh,this.type=t,this.baseY=this.mesh.position.y,this.animTime=0,this.leftArmPivot=n.leftArmPivot,this.rightArmPivot=n.rightArmPivot,this.leftLegPivot=n.leftLegPivot,this.rightLegPivot=n.rightLegPivot,this.legs=n.legs,this.abdomen=n.abdomen,this.head=n.head}update(n,t){this.animTime+=n*10,this.type==="spider"?this.animateSpider(t):t==="idle"?this.animateIdle():t==="walk"?this.animateWalk():t==="attack"?this.animateAttack():t==="jump"&&this.animateJump(n)}animateSpider(n){if(this.legs){if(n==="idle")this.legs.forEach(t=>{if(t.index===0){const o=t.side===0?1.5:1.2,a=t.side===0?0:1,i=Math.sin(this.animTime*o+a)*.2;t.upper.rotation.x=-Math.PI/4+i,t.lower.rotation.x=Math.PI/1.2-i*.5}else{const o=Math.sin(this.animTime*.5+t.index)*.05;t.upper.rotation.x=-Math.PI/4+o,t.lower.rotation.x=Math.PI/1.2}}),this.mesh.position.y=this.baseY+Math.sin(this.animTime)*.02;else if(n==="walk")this.legs.forEach(t=>{const a=(t.side+t.index)%2===0?0:Math.PI,i=Math.sin(this.animTime*2+a);t.upper.rotation.x=-Math.PI/4+i*.15,t.lower.rotation.x=Math.PI/1.2+i*.1,t.upper.parent&&(t.upper.parent.rotation.z=i*.2)}),this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime*2))*.04;else if(n==="attack")this.legs.forEach(t=>{if(t.index===0){const o=(Math.sin(this.animTime*3)+1)/2;t.upper.rotation.x=-Math.PI/4-o*.6,t.lower.rotation.x=Math.PI/1.2-o*.4,t.upper.parent&&(t.upper.parent.rotation.z=-o*1.2)}}),this.head&&(this.head.rotation.x=Math.sin(this.animTime*3)*.3);else if(n==="jump"){const t=Math.abs(Math.sin(this.animTime*1));this.mesh.position.y=this.baseY+t*2,this.legs.forEach(o=>{const a=Math.sin(this.animTime*1);o.upper.rotation.x=-Math.PI/4+a*.3,o.lower.rotation.x=Math.PI/1.2-a*.3})}}}animateIdle(){this.leftArmPivot&&(this.leftArmPivot.rotation.x=Math.sin(this.animTime)*.1),this.rightArmPivot&&(this.rightArmPivot.rotation.x=-Math.sin(this.animTime)*.1),this.leftLegPivot&&(this.leftLegPivot.rotation.x=0),this.rightLegPivot&&(this.rightLegPivot.rotation.x=0),this.mesh.position.y=this.baseY+Math.sin(this.animTime*2)*.02}animateWalk(){const n=Math.sin(this.animTime)*.5;this.leftLegPivot&&(this.leftLegPivot.rotation.x=n),this.rightLegPivot&&(this.rightLegPivot.rotation.x=-n),this.leftArmPivot&&(this.leftArmPivot.rotation.x=-n*.8),this.rightArmPivot&&(this.rightArmPivot.rotation.x=n*.8),this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime))*.05}animateAttack(){const n=(Math.sin(this.animTime*3)+1)/2,t=-Math.PI/2*n;this.leftArmPivot&&(this.leftArmPivot.rotation.x=t),this.rightArmPivot&&(this.rightArmPivot.rotation.x=t)}animateJump(n){this.mesh.position.y=this.baseY+Math.abs(Math.sin(this.animTime*2))*.5}}const oe=document.getElementById("categories");Object.keys(I).forEach(e=>{const n=document.createElement("div");n.className="category-group";const t=document.createElement("div");t.className="category-title",t.innerHTML=`<span>${e}</span> <span>${I[e].length}</span>`;const o=document.createElement("div");if(o.className="object-list",e==="enemies"&&o.classList.add("active"),t.onclick=()=>{document.querySelectorAll(".object-list").forEach(a=>a.classList.remove("active")),o.classList.add("active")},e==="enemies"){const a=document.createElement("div");a.className="object-item",a.style.background="rgba(100, 223, 223, 0.2)",a.style.fontWeight="bold",a.innerHTML='<span class="icon">ðŸ‘¥</span> View All Enemies',a.onclick=()=>ae(),o.appendChild(a)}I[e].forEach(a=>{const i=document.createElement("div");i.className="object-item",i.innerHTML=`<span class="icon">ðŸ“¦</span> ${a.name}`,i.onclick=()=>R(a),o.appendChild(i)}),n.appendChild(t),n.appendChild(o),oe.appendChild(n)});function z(){s&&(r.remove(s),s=null),Array.isArray(d)?(d.forEach(e=>{e.mesh&&r.remove(e.mesh)}),d=null):d&&(d.mesh&&r.remove(d.mesh),d=null),document.querySelectorAll(".enemy-label").forEach(e=>e.remove())}async function R(e){const n=document.getElementById("loading");if(n&&n.classList.remove("hidden"),document.querySelectorAll(".object-item").forEach(t=>t.classList.remove("active")),typeof event<"u"&&event&&typeof event.target<"u"&&event.target){const t=event.target.closest(".object-item");t&&t.classList.add("active")}document.getElementById("object-name").textContent=e.name,document.getElementById("object-type").textContent=e.id,z();try{const o=(await import(e.module))[e.createFn];if(!o)throw new Error(`Function ${e.createFn} not found in module`);const a=e.args||[];let i;if(e.id==="car"||e.id==="truck"?i=o(...a):e.id==="bus"||e.id==="motorcycle"?i=o():e.id==="player"?i=o({shirtColor:3447003,mouthStyle:"serious",showHat:!0,showGlasses:!1,weapon:"none"}):e.id==="femalePlayer"?i=o({shirtColor:15277667,hairColor:9127187,hairStyle:"long",mouthStyle:"smile",showEarrings:!0,showGlasses:!1,weapon:"none"}):e.module.includes("rockElement")?i=o(0,0,0):e.module.includes("houseElement")||e.module.includes("smallBuildingElement")||e.module.includes("plateauElement")?i=o(...a):e.module.includes("treeOakElement")||e.module.includes("treeAlpineElement")||e.module.includes("bushElement")?i=o():i=o(r,0,0,0,...a),i.isObject3D)s=i;else if(i.mesh)s=i.mesh,e.animated&&(d=new F(i,e.id));else throw console.error("Unknown object format:",i),new Error("Object format not recognized (must be Object3D or have .mesh property)");r.add(s);const y=document.getElementById("anim-controls"),l=document.getElementById("anim-speed-control");y&&l&&(e.animated?(y.style.display="block",l.style.display="block"):(y.style.display="none",l.style.display="none"));const m={vehicle:document.getElementById("vehicle-color-control"),house:document.getElementById("house-color-control"),bush:document.getElementById("bush-scale-control"),bus:document.getElementById("bus-scale-control"),player:document.getElementById("player-controls"),femalePlayer:document.getElementById("female-player-controls")};Object.values(m).forEach(f=>{f&&(f.style.display="none")}),e.id==="car"||e.id==="truck"?m.vehicle&&(m.vehicle.style.display="block"):e.id==="house"?m.house&&(m.house.style.display="block"):e.id==="bush"?m.bush&&(m.bush.style.display="block"):e.id==="bus"?m.bus&&(m.bus.style.display="block"):e.id==="player"?m.player&&(m.player.style.display="block"):e.id==="femalePlayer"&&m.femalePlayer&&(m.femalePlayer.style.display="block"),c=e,_(s);const p={plateau:27,mansion:35,smallBuilding:21};if(p[e.id]){const b=new O().setFromObject(s).getCenter(new B),E=p[e.id],x=new B().subVectors(u.position,b).normalize();u.position.copy(b).add(x.multiplyScalar(E)),u.lookAt(b),m.target.copy(b),m.update();const j=document.getElementById("zoom-slider"),T=document.getElementById("zoom-value");j&&T&&(j.value=E,T.textContent=E.toFixed(1))}}catch(t){console.error("Error loading object:",t),alert("Failed to load object: "+t.message)}finally{n&&n.classList.add("hidden")}}function _(e){const n=new O().setFromObject(e),t=n.getCenter(new B),o=n.getSize(new B),a=Math.max(o.x,o.y,o.z),i=u.fov*(Math.PI/180);let y=Math.abs(a/2*Math.tan(i*2));y=Math.max(y,a*1.5),a>20&&(y*=1.2);const l=y;u.position.set(t.x+l,t.y+l*.5,t.z+l),u.lookAt(t),h.target.copy(t),h.update();const m=u.position.distanceTo(t),p=document.getElementById("zoom-slider"),f=document.getElementById("zoom-value");p&&f&&(p.value=m,f.textContent=m.toFixed(1))}window.resetCamera=()=>{s?_(s):(u.position.set(5,4,5),h.target.set(0,1,0))};window.toggleRotation=()=>{k=!k,h.autoRotate=k};window.toggleDayNight=()=>{S=!S,S?(r.background=new M(657930),r.fog.color.set(657930),A.intensity=.1,w.intensity=.2):(r.background=new M(2962486),r.fog.color.set(2962486),A.intensity=.6,w.intensity=1)};window.applyVehicleColor=async()=>{if(!c||c.id!=="car"&&c.id!=="truck")return;const n=document.getElementById("vehicle-color").value,t=parseInt(n.slice(1),16),o={...c,customColor:t};await V(o)};window.randomVehicleColor=async()=>{if(!c||c.id!=="car"&&c.id!=="truck")return;const e=[1668818,15921906,1118481,9116186,15022389,15844367,48340,16733986,5025616],n=e[Math.floor(Math.random()*e.length)];document.getElementById("vehicle-color").value="#"+n.toString(16).padStart(6,"0"),await applyVehicleColor()};document.getElementById("bush-scale").addEventListener("input",e=>{document.getElementById("bush-scale-value").textContent=parseFloat(e.target.value).toFixed(1)});window.applyBushScale=async()=>{if(!c||c.id!=="bush")return;const e=document.getElementById("bush-scale"),n=parseFloat(e.value);s&&(r.remove(s),s=null),d=null;try{const o=(await g(()=>import("./bushElement-BmJBkeri.js"),__vite__mapDeps([0,1]))).createBush;s=o(n),r.add(s)}catch(t){console.error("Error reloading bush with scale:",t)}};document.getElementById("bus-scale").addEventListener("input",e=>{document.getElementById("bus-scale-value").textContent=parseFloat(e.target.value).toFixed(1)});window.applyBusScale=async()=>{if(!c||c.id!=="bus")return;const e=document.getElementById("bus-scale"),n=parseFloat(e.value);s&&(r.remove(s),s=null),d=null;try{const o=(await g(()=>import("./busElement-DikC1tJ7.js"),__vite__mapDeps([2,1]))).createBus;s=o(n),r.add(s)}catch(t){console.error("Error reloading bus with scale:",t)}};window.applyPlayerSettings=async()=>{if(!c||c.id!=="player")return;const e=document.getElementById("player-shirt-color").value,n=document.getElementById("player-mouth").value,t=document.getElementById("player-hat").checked,o=document.getElementById("player-glasses").checked,a=document.getElementById("player-weapon").value;s&&(r.remove(s),s=null),d=null;try{const y=(await g(()=>import("./playerElement-DDZppg7c.js"),__vite__mapDeps([3,1]))).createPlayer,l=y({shirtColor:parseInt(e.replace("#","0x")),mouthStyle:n,showHat:t,showGlasses:o,weapon:a});l.mesh?(s=l.mesh,c.animated&&(d=new F(l,c.id))):s=l,r.add(s)}catch(i){console.error("Error reloading player with settings:",i)}};window.applyFemalePlayerSettings=async()=>{if(!c||c.id!=="femalePlayer")return;const e=document.getElementById("female-shirt-color").value,n=document.getElementById("female-hair-color").value,t=document.getElementById("female-hair-style").value,o=document.getElementById("female-mouth").value,a=document.getElementById("female-earrings").checked,i=document.getElementById("female-glasses").checked,y=document.getElementById("female-weapon").value;s&&(r.remove(s),s=null),d=null;try{const m=(await g(()=>import("./femalePlayerElement-D5Uxa6Yv.js"),__vite__mapDeps([4,1]))).createFemalePlayer,p=m({shirtColor:parseInt(e.replace("#","0x")),hairColor:parseInt(n.replace("#","0x")),hairStyle:t,mouthStyle:o,showEarrings:a,showGlasses:i,weapon:y});p.mesh?(s=p.mesh,c.animated&&(d=new F(p,c.id))):s=p,r.add(s)}catch(l){console.error("Error reloading female player with settings:",l)}};window.applyHouseColors=async()=>{if(!c||!["house","mansion","cabin"].includes(c.id))return;const e=document.getElementById("wall-color"),n=document.getElementById("roof-color"),t=parseInt(e.value.slice(1),16),o=parseInt(n.value.slice(1),16),a={...c,customWallColor:t,customRoofColor:o};await V(a)};async function V(e){s&&(r.remove(s),s=null),d=null;try{const t=(await import(e.module))[e.createFn],o=e.args||[];let a;if(e.id==="car"||e.id==="truck")a=t(o[0]||e.id,e.customColor||null);else if(["house","mansion","cabin"].includes(e.id))a=t(o[0]||1,e.customWallColor,e.customRoofColor);else return;if(a.isObject3D)s=a;else if(a.mesh)s=a.mesh;else{console.error("Unknown object format:",a);return}r.add(s),_(s)}catch(n){console.error("Error reloading object with color:",n)}}async function ae(){document.querySelectorAll(".object-item").forEach(e=>e.classList.remove("active")),event.target.closest(".object-item").classList.add("active"),document.getElementById("object-name").textContent="All Enemies",document.getElementById("object-type").textContent="Group View",z(),document.getElementById("anim-controls").style.display="block",document.getElementById("anim-speed-control").style.display="block",document.getElementById("vehicle-color-control").style.display="none",document.getElementById("house-color-control").style.display="none";try{const{createNormalZombie:e}=await g(async()=>{const{createNormalZombie:l}=await import("./normalZombieElement-DnB3_ElI.js");return{createNormalZombie:l}},__vite__mapDeps([5,1])),{createFatZombie:n}=await g(async()=>{const{createFatZombie:l}=await import("./fatZombieElement-CN_k09VM.js");return{createFatZombie:l}},__vite__mapDeps([6,1])),{createBigZombie:t}=await g(async()=>{const{createBigZombie:l}=await import("./bigZombieElement-BwYxHNPs.js");return{createBigZombie:l}},__vite__mapDeps([7,1])),{createSlenderman:o}=await g(async()=>{const{createSlenderman:l}=await import("./slendermanElement-xZvndKHS.js");return{createSlenderman:l}},__vite__mapDeps([8,1])),{createSpider:a}=await g(async()=>{const{createSpider:l}=await import("./spiderElement-hFDYL3-m.js");return{createSpider:l}},__vite__mapDeps([9,1])),i=[],y=[{type:"normal",x:-8,name:"Normal Zombie",createFn:e},{type:"fat",x:-4,name:"Fat Zombie",createFn:n},{type:"big",x:0,name:"Big Zombie",createFn:t},{type:"slender",x:4,name:"Slenderman",createFn:o},{type:"spider",x:8,name:"Spider",createFn:a}];document.querySelectorAll(".enemy-label").forEach(l=>l.remove()),y.forEach(({type:l,x:m,name:p,createFn:f})=>{const b=f(r,m,0,0),E=new F(b,l);E.enemyType=l,E.enemyName=p,i.push(E);const x=document.createElement("div");x.className="enemy-label",x.textContent=p,x.id=`enemy-label-${l}`,document.body.appendChild(x)}),d=i,c=null,u.position.set(0,4,15),h.target.set(0,2,0),h.update()}catch(e){console.error("Error loading all enemies:",e),alert("Failed to load all enemies: "+e.message)}}function ie(){Array.isArray(d)&&d.forEach(e=>{if(!e.enemyType||!e.mesh)return;const n=e.mesh.position.clone(),t=e.enemyType==="slender"?3.5:e.enemyType==="big"?5:e.enemyType==="spider"?1.5:2.5;n.y+=t,n.project(u);const o=(n.x*.5+.5)*window.innerWidth,a=(-(n.y*.5)+.5)*window.innerHeight,i=document.getElementById(`enemy-label-${e.enemyType}`);i&&(i.style.left=o+"px",i.style.top=a+"px")})}document.querySelectorAll("[data-anim]").forEach(e=>{e.addEventListener("click",n=>{document.querySelectorAll("[data-anim]").forEach(t=>t.classList.remove("active")),n.target.classList.add("active"),L=n.target.dataset.anim})});document.getElementById("anim-speed").addEventListener("input",e=>{P=parseFloat(e.target.value),document.getElementById("speed-value").textContent=P.toFixed(1)});document.getElementById("zoom-slider").addEventListener("input",e=>{const n=parseFloat(e.target.value);document.getElementById("zoom-value").textContent=n.toFixed(1);const t=new B().subVectors(u.position,h.target).normalize();u.position.copy(h.target).add(t.multiplyScalar(n)),h.update()});h.addEventListener("change",()=>{const e=u.position.distanceTo(h.target),n=document.getElementById("zoom-slider"),t=document.getElementById("zoom-value");n&&t&&document.activeElement!==n&&(n.value=e,t.textContent=e.toFixed(1))});window.addEventListener("resize",()=>{u.aspect=window.innerWidth/window.innerHeight,u.updateProjectionMatrix(),v.setSize(window.innerWidth,window.innerHeight)});const se=new X;function Z(){requestAnimationFrame(Z);const e=se.getDelta();d&&P>0&&(Array.isArray(d)?(d.forEach(n=>{n.update(e*P,L)}),ie()):d.update(e*P,L)),h.update(),v.render(r,u)}Z();(async()=>{const e=document.getElementById("loading");try{if(I.characters){const n=I.characters.find(t=>t.id==="player");n&&(console.log("Loading default object:",n),await R(n))}}catch(n){console.error("Error loading default object:",n)}e&&e.classList.add("hidden")})();
